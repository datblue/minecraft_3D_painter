<html>
<head>
	<meta charset="UTF-8">
	<title>minecraft editor arm4px</title>
	<!-- <script type="text/javascript" src="three.js"></script> -->
	<script type="text/javascript" src="js/THREE.js"></script>


	<script type="text/javascript" src="js/TrackballControls.js"></script>
	<script type="text/javascript" src="js/OrbitControls.js"></script>
	<!-- <script type="text/javascript" src="js/Clock.js"></script> -->
	<script src="js/Projector.js"></script>
	<script src="js/CanvasRenderer.js"></script>
	<script type="text/javascript" src="js/stats.min.js"></script>

	<!-- <link href="bootstrap.min.css" rel="stylesheet"> -->
	<!-- <link href="//cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" rel="stylesheet"> -->
	<link href="dist/css/bootstrap-colorpicker.min.css" rel="stylesheet">
	<link href="docs/assets/main.css" rel="stylesheet">

	<script src="dist/js/jquery-3.1.1.min.js"></script>
	<script src="bootstrap.min.js"></script>

	<script src="dist/js/bootstrap-colorpicker.js"></script>
	<style>
		body { margin: 0; overflow: hidden; }
		/*canvas { width: 100%; height: 100% }*/
		#to2D{
			position: absolute;
			bottom: 0;
			left: 0;
			padding-left: 40px;
			padding-bottom: 20px;
		}
		#myCanvas{
			display: none;
		}
		#paintOptions{
			position: absolute;
			top: 0;
			left: 0;
		}
		#paintOptions li{
			list-style:  none;
			/*border: 1px solid grey;*/
			/*background: rgb(224,224,224);*/
			padding: 4px 6px;
		}
		.op-img{
			width: 40px;
			height: 40px;
			padding: 10px;
			border-radius: 4px;
		}
		.op-img:hover{
			background: white;
		}

		#download{			
			text-decoration: none;
			border: 1px solid #eeeeee;
			background: #cccccc;
			padding: 6px 10px;
			border-radius: 4px;
			color: black;
		}
		#download:hover{
			background: white;
		}
		#skin-image-file{			
			text-decoration: none;
			border: 1px solid #eeeeee;
			background: #cccccc;
			padding: 6px 10px;
			border-radius: 4px;
			color: black;
		}
		#skin-image-file:hover{
			background: white;
		}
		/*outline*/
		.outline-item{
			background: #cccccc;
			border: 1px solid #cccccc;
		}
		#head{
			position: absolute;
			width: 60px;
			height: 60px;
			background: #cccccc;
			right: 200px;	
			top: 150px;
			/*bottom: 220px;*/
		}
		#body{
			position: absolute;
			width: 60px;
			height: 90px;
			background: #cccccc;
			right: 200px;	
			top: 220px;
			/*bottom: 120px;*/
		}
		#leftArm{
			position: absolute;
			width: 25px;
			height: 90px;
			background: #cccccc;
			right: 165px;	
			top: 220px;
			/*bottom: 120px;*/
		}
		#rightArm{
			position: absolute;
			width: 25px;
			height: 90px;
			background: #cccccc;
			right: 270px;	
			top: 220px;
			/*bottom: 120px;*/
		}
		#leftLeg{
			position: absolute;
			width: 25px;
			height: 90px;
			background: #cccccc;
			right: 200px;	
			top: 320px;
			/*bottom: 20px;*/
		}
		#rightLeg{
			position: absolute;
			width: 25px;
			height: 90px;
			background: #cccccc;
			right: 235px;	
			top: 320px;
			/*bottom: 20px;*/
		}
		.sw{
			position: absolute;
			background: #f0f0f0;
			text-align: center;		
		}
		.sw:hover{
			cursor: pointer;
		}
		.sw a{
			text-align: center;
			display: inline-block;
			padding-top: 4px;
			height: 100%;
			width: 100%;
		}
		#arm3{
			top: 60px;
			right: 240px;
			height: 30px;
			width: 70px;
		}
		#arm4{
			top: 60px;
			right: 155px;
			height: 30px;
			width: 70px;
			background: #cccccc;
			cursor: default;
		}
		a{
			text-decoration: none;
		}
		#body-sw{
			top: 100px;
			right: 240px;
			/*height: 30px;*/
			width: 70px;
			padding-top: 6px;
			padding-bottom: 6px;
		}
		#overlay-sw{
			top: 100px;
			right: 155px;
			/*height: 30px;*/
			width: 70px;
			padding-top: 6px;
			padding-bottom: 6px;
		}
	</style>
</head>
<body>
	<div id="paintOptions">
		<ul>
			<div id="picker" class="inl-bl"></div>		
			<script> $(function() { $('#picker').colorpicker({ color: '#0c7708', container: true, inline: true }); }); </script>
			<li id="areaPaint" onclick="areaPaint()"><img src="paint-bucket.png" class="op-img" id="paint-bucket"></img></li>
			<li onclick="usepen()"><img src="pencil.png" id="pen" class="op-img"/></li>
			<li onclick="erase()"><img src="erase.png" class="op-img" /></li>
			<li onclick="move()"><img src="move.gif" class="op-img"  style="width: 40px;" /></li>
		</ul>
	</div>
	<div id="to2D">
		<!-- <button onclick="draw()">draw</button> -->
		<a id="download" class="btn btn-sm btn-primary" download="minecraftskin.png">Save png</a>	
		<!-- 		<style> .inl-bl { display: inline-block; } </style>  -->
		<input id="skin-image-file" type="file"  onchange="upload()" />
		<img id="upload-img" style="display: none;" />
	</div>
	<canvas id="myCanvas"  width="64" height="64"></canvas>	
	<div id="switches">
		<div id="arm3" class="sw"><a href="index2.html">3px</a></div>
		<div id="arm4" class="sw"><a>4px</a></div>		
		<div id="body-sw" class="sw" onclick="bodySW()">Body</div>
		<div id="overlay-sw" class="sw" onclick="overlaySW()">Overlay</div>
	</div>
	<div id="outline">
		<div id="head" class="outline-item" onclick="headClick()"></div>			
		<div id="leftArm" class="outline-item" onclick="leftArmClick()"></div>
		<div id="body" class="outline-item" onclick="bodyClick()"></div>
		<div id="rightArm" class="outline-item" onclick="rightArmClick()"></div>
		<div id="leftLeg" class="outline-item" onclick="leftLegClick()"></div>
		<div id="rightLeg" class="outline-item" onclick="rightLegClick()"></div>
	</div>
	<script type="text/javascript">
		var scene, camera, renderer;		
		var raycaster = new THREE.Raycaster();

		var mouse = new THREE.Vector2();
		var objects = [];			

			// var WIDTH = 1200, HEIGHT = 600;
			// var WIDTH = window.innerWidth, HEIGHT = window.innerHeight;
			// var WIDTH = containerPosition.width, HEIGHT = containerPosition.height;
			var model;

		// var mouseState =0;
		var paintState =0;
		var eraseState = 0;
		var areaPaintState = 0;
		var penState = 1;

		var moveState = 0;

		var headState = 0;
		var bodyState = 0;		
		var leftArmState = 0;
		var rightArmState = 0;
		var rightLegState = 0;
		var leftLegState = 0;

		var SCENECOLOR = '#FFFF90';
		// var SCENECOLOR = '#e7f42e';
		var OUTLINECOLOR = '#cccccc';
		var SWCOLOR = '#f0f0f0';
		var bodyDisplayState =0;
		var overlayDisplayState =0;

		// var headBoxDiffX=0;
		// var headBoxDiffY=0;var leftArmBoxDiffX = 0;var rightArmBoxDiffX = 0;var rightLegBoxDiffX = 0; leftLegBoxDiffX =0;

		// var headState, bodyState, leftArmState, rightArmState, leftLegState, rightLegState = true;
		
		// var faceMaterial = new THREE.MeshBasicMaterial({ 
		// 	color:0xFFFFFF, 
		// 	side:THREE.DoubleSide 
		// }); 
		init();
		render();

		function init(){			
			// basic factors
			scene = new THREE.Scene();			
			scene.background = new THREE.Color( 0xFFFF90 );
			camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );			
			camera.position.set( 0, 0, 34 );			
			camera.lookAt(new THREE.Vector3(0, 0, 0));
			
			renderer = new THREE.CanvasRenderer();
			// renderer = new THREE.WebGLRenderer();
			renderer.autoClear = false;
			renderer.setSize( window.innerWidth, window.innerHeight );
			renderer.sortObjects = true;
			// cameraControls = new THREE.OrbitControls(camera, renderer.domElement);
			cameraControls = new THREE.OrbitControls(camera, renderer.domElement);

			// draw models
			model = new Character(0, 0, 0, 4);
			// var x= 0, y=0,z=0;
   //              var headBorder = new PartFrame(x,y+10,z,8,8,8,1);
   //              scene.add(headBorder);

			// var model = new character4(0, 0, 0);
			//
			window.addEventListener( 'resize', onWindowResize, false );
			window.addEventListener( 'mousedown', onMouseDown, false );
			window.addEventListener( 'mouseup', onMouseUp, false );
			window.addEventListener( 'mousemove', onMouseMove, false );
			// document.body.appendChild( renderer.domElement );
			
			document.body.appendChild(renderer.domElement);
		}

		function Character(x,y,z, a){ // x,y,z is model position // a is arm width (3 or 4)	
			if (a==3){
				var leftArm = new CharacterLeftArm3(x,y,z);	
				var leftArmOverlay = new LeftArm3Overlay(x,y,z);	
				var leftArmBorder = new PartFrame(x+5.5,y,z,3,12,4,1);
				scene.add(leftArmBorder);
				var rightArm = new CharacterRightArm3(x,y,z);
				var rightArmOverlay = new RightArm3Overlay(x,y,z);
				var rightArmBorder = new PartFrame(x-5.5,y,z,3,12,4,1);
				scene.add(rightArmBorder);

			}
			else{
				var leftArm = new CharacterLeftArm4(x,y,z);	
				var leftArmOverlay = new LeftArm4Overlay(x,y,z);	
				var leftArmBorder = new PartFrame(x+6,y,z,4,12,4,1);
				scene.add(leftArmBorder);
				var rightArm = new CharacterRightArm4(x,y,z);	
				var rightArmOverlay = new RightArm4Overlay(x,y,z);
				var rightArmBorder = new PartFrame(x-6,y,z,4,12,4,1);
				scene.add(rightArm.mesh);	
				scene.add(rightArmBorder);



			}
			var head = new CharacterHead(x, y, z);
			// var he = new CharacterHead(x, y, z);
			// scene.add(he.mesh);
			// scene.add(head.mesh);
			var headOverlay = new HeadOverlay(x,y,z);
			// scene.add(headOverlay.mesh);
			var headBorder = new PartFrame(x,y+10,z,8,8,8,1);
			scene.add(headBorder);
			var body = new CharacterBody(x,y,z);
			scene.add(body.mesh);
			var bodyOverlay = new BodyOverlay(x,y,z);			
			scene.add(bodyOverlay.mesh);
			var bodyBorder = new PartFrame(0,0,0,8,12,4,1);
		// var bodyBorder = new PartBorder(0,0,0,8,12,4,1);
		scene.add(bodyBorder);
		var leftLeg = new CharacterLeftLeg(x,y,z);
		// scene.add(leftLeg.mesh);
		var leftLegOverlay = new LeftLegOverlay(x,y,z);
		// scene.add(leftLegOverlay.mesh);
		var leftLegBorder = new PartFrame(x+2,y-12,z,4,12,4,1);
		// var leftLegBorder = new PartBorder(x+2,y-12,z,4,12,4,1);
		scene.add(leftLegBorder);
		var rightLeg = new CharacterRightLeg(x,y,z);
		// scene.add(rightLeg.mesh);
		var rightLegOverlay = new RightLegOverlay(x,y,z);
		// scene.add(rightLegOverlay.mesh);
		var rightLegBorder = new PartFrame(x-2,y-12,z,4,12,4,1);
		// var rightLegBorder = new PartBorder(x-2,y-12,z,4,12,4,1);
		scene.add(rightLegBorder);

		head.mesh.position.set(0,0,0);
		headOverlay.mesh.position.set(0,0,0);		

		this.head = head.mesh;
		this.headOverlay = headOverlay.mesh;
		this.headTop = head.top;
		this.headTopOverlay = headOverlay.top;
		this.headBot = head.bot;
		this.headBotOverlay = headOverlay.bot
		this.headLeft = head.left;
		this.headLeftOverlay = headOverlay.left;
		this.headFront = head.front;
		this.headFrontOverlay = headOverlay.front;
		this.headRight =  head.right;
		this.headRightOverlay =  headOverlay.right;
		this.headBack = head.back;
		this.headBackOverlay = headOverlay.back;

		this.headBorder = headBorder;


		this.body = body.mesh;
		this.bodyOverlay = bodyOverlay.mesh;
		this.bodyTop = body.top;
		this.bodyBot = body.bot;
		this.bodyLeft = body.left;
		this.bodyFront = body.front;
		this.bodyRight = body.right;
		this.bodyBack = body.back;

		this.bodyBorder = bodyBorder;

		this.bodyOverlay = bodyOverlay.mesh;
		this.bodyTopOverlay = bodyOverlay.top;
		this.bodyBotOverlay = bodyOverlay.bot;
		this.bodyLeftOverlay = bodyOverlay.left;
		this.bodyFrontOverlay = bodyOverlay.front;
		this.bodyRightOverlay = bodyOverlay.right;
		this.bodyBackOverlay = bodyOverlay.back;
		// this.leftLeg = leftLeg;
		// this.leftLegBorder = leftLegBorder;	

		this.rightLeg = rightLeg.mesh;		
		this.rightLegTop = rightLeg.top;
		this.rightLegBot = rightLeg.bot;
		this.rightLegRight = rightLeg.right;
		this.rightLegFront = rightLeg.front;
		this.rightLegLeft = rightLeg.left;
		this.rightLegBack = rightLeg.back;
		this.rightLegBorder = rightLegBorder;	

		this.rightLegOverlay = rightLegOverlay.mesh;
		this.rightLegTopOverlay = rightLegOverlay.top;
		this.rightLegBotOverlay = rightLegOverlay.bot;
		this.rightLegRightOverlay = rightLegOverlay.right;
		this.rightLegFrontOverlay = rightLegOverlay.front;
		this.rightLegLeftOverlay = rightLegOverlay.left;
		this.rightLegBackOverlay = rightLegOverlay.back;		

		this.leftLeg = leftLeg.mesh;
		this.leftLegTop = leftLeg.top;
		this.leftLegBot = leftLeg.bot;
		this.leftLegRight = leftLeg.right;
		this.leftLegFront = leftLeg.front;
		this.leftLegLeft = leftLeg.left;
		this.leftLegBack = leftLeg.back;
		this.leftLegBorder = leftLegBorder;	

		this.leftLegOverlay = leftLegOverlay.mesh;
		this.leftLegTopOverlay = leftLegOverlay.top;
		this.leftLegBotOverlay = leftLegOverlay.bot;
		this.leftLegRightOverlay = leftLegOverlay.right;
		this.leftLegFrontOverlay = leftLegOverlay.front;
		this.leftLegLeftOverlay = leftLegOverlay.left;
		this.leftLegBackOverlay = leftLegOverlay.back;

		
		
		var headBox = new THREE.Mesh();	
		head.mesh.position.y = -6;	
		headOverlay.mesh.position.y = -6;	
		headBorder.position.y = -6;
		headBox.position.y = 6;
		headBox.add(head.mesh);		
		headBox.add(headOverlay.mesh);
		headBox.add(headBorder);
		scene.add(headBox);
		this.headBox = headBox;		

		var leftLegBox = new THREE.Mesh();
		leftLeg.mesh.position.y = +6;		
		leftLegOverlay.mesh.position.y = +6;		
		leftLegBorder.position.y = +6;
		leftLegBox.position.y = -6;
		leftLegBox.add(leftLeg.mesh);		
		leftLegBox.add(leftLegOverlay.mesh);		
		leftLegBox.add(leftLegBorder);
		scene.add(leftLegBox);
		this.leftLegBox = leftLegBox;

		var rightLegBox = new THREE.Mesh();
		rightLegOverlay.mesh.position.y = +6;		
		rightLeg.mesh.position.y = +6;	
		rightLegBorder.position.y = +6;
		rightLegBox.position.y = -6;
		rightLegBox.add(rightLeg.mesh);		
		rightLegBox.add(rightLegOverlay.mesh);	
		rightLegBox.add(rightLegBorder);
		scene.add(rightLegBox);
		this.rightLegBox = rightLegBox;

		
		this.leftArm = leftArm.mesh;	
		this.leftArmOverlay = leftArmOverlay.mesh;
		this.leftArmTop = leftArm.top;
		this.leftArmTopOverlay = leftArmOverlay.top;
		this.leftArmBot = leftArm.bot;
		this.leftArmBotOverlay = leftArmOverlay.bot;
		this.leftArmLeft = leftArm.left;
		this.leftArmLeftOverlay = leftArmOverlay.left;
		this.leftArmFront = leftArm.front;
		this.leftArmFrontOverlay = leftArmOverlay.front;
		this.leftArmRight = leftArm.right;
		this.leftArmRightOverlay = leftArmOverlay.right;
		this.leftArmBack = leftArm.back;
		this.leftArmBackOverlay = leftArmOverlay.back;

		this.rightArm = rightArm.mesh;
		this.rightArmTop = rightArm.top;
		this.rightArmBot = rightArm.bot;
		this.rightArmRight = rightArm.right;
		this.rightArmFront = rightArm.front;
		this.rightArmLeft = rightArm.left;
		this.rightArmBack = rightArm.back;

		this.rightArmOverlay = rightArmOverlay.mesh;
		this.rightArmTopOverlay = rightArmOverlay.top;
		this.rightArmBotOverlay = rightArmOverlay.bot;
		this.rightArmRightOverlay = rightArmOverlay.right;
		this.rightArmFrontOverlay = rightArmOverlay.front;
		this.rightArmLeftOverlay = rightArmOverlay.left;
		this.rightArmBackOverlay = rightArmOverlay.back;

		this.leftArmBorder = leftArmBorder;
		this.rightArmBorder = rightArmBorder;	

		var leftArmBox = new THREE.Mesh();
		leftArm.mesh.position.y = -6;		
		leftArmOverlay.mesh.position.y = -6;	
		leftArmBorder.position.y = -6;
		leftArmBox.position.y = 6;
		leftArmBox.add(leftArm.mesh);	
		leftArmBox.add(leftArmOverlay.mesh);	
		leftArmBox.add(leftArmBorder);
		scene.add(leftArmBox);
		this.leftArmBox = leftArmBox;

		var rightArmBox = new THREE.Mesh();
		rightArm.mesh.position.y = -6;		
		rightArmOverlay.mesh.position.y = -6;	
		rightArmBorder.position.y = -6;
		rightArmBox.position.y = 6;
		rightArmBox.add(rightArm.mesh);		
		rightArmBox.add(rightArmOverlay.mesh);	
		rightArmBox.add(rightArmBorder);
		scene.add(rightArmBox);
		this.rightArmBox = rightArmBox;		
		
		
		
		

	}
	function PartFrame(x,y,z,m,n,p,r){// border for a part like a leg, a head// x,y,z is position, m,n,p are width, height,depth r is width of a mini square		
		var mesh = new THREE.Mesh();
		//front		
		var line = MyLine(x-m/2,y-n/2,z+p/2,x-m/2,y+n/2,z+p/2);
		mesh.add(line);
		var line = MyLine(x-m/2,y+n/2,z+p/2,x+m/2,y+n/2,z+p/2);
		mesh.add(line);
		var line = MyLine(x+m/2,y+n/2,z+p/2,x+m/2,y-n/2,z+p/2);
		mesh.add(line);
		var line = MyLine(x-m/2,y-n/2,z+p/2,x+m/2,y-n/2,z+p/2);
		mesh.add(line);
		//bot
		var line = MyLine(x-m/2,y-n/2,z+p/2,x-m/2,y-n/2,z-p/2);
		mesh.add(line);
		var line = MyLine(x-m/2,y-n/2,z-p/2,x+m/2,y-n/2,z-p/2);
		mesh.add(line);
		var line = MyLine(x+m/2,y-n/2,z-p/2,x+m/2,y-n/2,z+p/2);
		mesh.add(line);
		//top
		var line = MyLine(x-m/2,y+n/2,z+p/2,x-m/2,y+n/2,z-p/2);
		mesh.add(line);
		var line = MyLine(x-m/2,y+n/2,z-p/2,x+m/2,y+n/2,z-p/2);
		mesh.add(line);
		var line = MyLine(x+m/2,y+n/2,z-p/2,x+m/2,y+n/2,z+p/2);
		mesh.add(line);
		//back
		var line = MyLine(x-m/2,y-n/2,z-p/2,x-m/2,y+n/2,z-p/2);
		mesh.add(line);
		var line = MyLine(x+m/2,y-n/2,z-p/2,x+m/2,y+n/2,z-p/2);
		mesh.add(line);
		// var line = new LineBorder(x-m/2,y-n/2,z+p/2,x-m/2, y+n/2,z+p/2,x+m/2,y+n/2,z+p/2,x+m/2,y-n/2,z+p/2);			
		// mesh.add(line);
		// var line = new LineBorder(x-m/2,y-n/2,z+p/2,x-m/2, y+n/2,z+p/2,x+m/2,y+n/2,z+p/2,x+m/2,y-n/2,z+p/2);			
		// mesh.add(line);
		// var line = new LineBorder(x-m/2,y-n/2,z+p/2,x-m/2, y+n/2,z+p/2,x+m/2,y+n/2,z+p/2,x+m/2,y-n/2,z+p/2);			
		// mesh.add(line);
		return mesh;
	}	
	function MyLine(x1,y1,z1,x2,y2,z2){
		var line = new THREE.Mesh();			
		var geometry = new THREE.Geometry();
		geometry.vertices.push(
			new THREE.Vector3(x1,y1,z1),
			new THREE.Vector3(x2,y2,z2));
		// var material = new THREE.LineBasicMaterial({ color: 0x414842 });
		// var material = new THREE.LineBasicMaterial({ color: 0x999966 });
		// 0x808080
		var material = new THREE.LineBasicMaterial({ color: 0x434343});
		line = new THREE.Line(geometry, material);	
		line.renderOrder = 100;		
		return line;
	}
		function PartBorder(x,y,z,m,n,p,r){// border for a part like a leg, a head// x,y,z is position, m,n,p are width, height,depth r is width of a mini square
			//0,0,0,8,12,4,1
			if(m===3){
				var mesh = new THREE.Mesh();
				for (var i = 0; i <=m-1; i++) {
					var line = new LineBorder(x-1.5+i+1,y-n/2,z+p/2,x-1.5+i+1,y+n/2,z+p/2,x-1.5+i+1,y+n/2,z-p/2,x-1.5+i+1,y-n/2,z-p/2);			
					mesh.add(line);
				}
				for (var i = 0; i <=n-1; i++) {
					var line = new LineBorder(x-1.5,y-n/2+i+1,z+p/2,x-1.5,y-n/2+i+1,z-p/2,x+1.5,y-n/2+i+1,z-p/2,x+1.5,y-n/2+i+1,z+p/2);			
					mesh.add(line);
				}
				for (var i = 0; i <=p; i++) {
					var line = new LineBorder(x-1.5,y-n/2,z-p/2+i,x-1.5,y+n/2,z-p/2+i,x+1.5,y+n/2,z-p/2+i,x+1.5,y-n/2,z-p/2+i);			
					mesh.add(line);
				}
				return mesh;
			}else{
				var mesh = new THREE.Mesh();
				for (var i = 0; i <=m-1; i++) {
					var line = new LineBorder(x-m/2+i+1,y-n/2,z-p/2,x-m/2+i+1,y+n/2,z-p/2,x-m/2+i+1,y+n/2,z+p/2,x-m/2+i+1,y-n/2,z+p/2);			
					mesh.add(line);
				}
				for (var i = 0; i <=p; i++) {
					var line = new LineBorder(x-m/2,y-n/2,z-p/2+i,x-m/2,y+n/2,z-p/2+i,x+m/2,y+n/2,z-p/2+i,x+m/2,y-n/2,z-p/2+i);			
					mesh.add(line);
				}
				for (var i = 0; i <=n-1; i++) {
					var line = new LineBorder(x-m/2,y-n/2+i+1,z-p/2,x-m/2,y-n/2+i+1,z+p/2,x+m/2,y-n/2+i+1,z+p/2,x+m/2,y-n/2+i+1,z-p/2);			
					mesh.add(line);
				}
				return mesh;
			}
		}

		function LineBorder(x1,y1,z1,x2,y2,z2,x3,y3,z3,x4,y4,z4){// border for a side of a part
			var line = new THREE.Mesh();			
			var geometry = new THREE.Geometry();
			geometry.vertices.push(
				new THREE.Vector3(x1,y1,z1),
				new THREE.Vector3(x2,y2,z2),
				new THREE.Vector3(x3,y3,z3),
				new THREE.Vector3(x4,y4,z4),
				new THREE.Vector3(x1,y1,z1)
				);
			var material = new THREE.LineBasicMaterial({ color: 0x999966 });
			line = new THREE.Line(geometry, material);			
			return line;
		}
		function CharacterLeftArm3(x,y,z){			
			var mesh = new THREE.Mesh();

			var front = new planeSide(x+5.5,y,z+2,3,12);
			mesh.add(front);
			
			var back = new planeSide(x+5.5,y,z-2,3,12);
			mesh.add(back);
			
			var right = new planeSide(x,y,z+4,4,12);
			right.rotateY(Math.PI/2);
			mesh.add(right);
			
			var left = new planeSide(x,y,z+7,4,12);
			left.rotateY(+Math.PI/2);
			mesh.add(left);
			
			var top = new planeSide(x+5.5,y,z+6,3,4);
			top.rotateX(-Math.PI/2);
			mesh.add(top);
			
			var bot = new planeSide(x+5.5,y,z+6,3,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;	
		}
		function LeftArm3Overlay(x,y,z){		
			var s = 0.2;
			var a = (3+s)/3;
			var b = (12+s)/12;
			var c = (4+s)/4;

			var mesh = new THREE.Mesh();

			var front = new overlayPlane(x+5.5,y,z+2*c,3,12);
			mesh.add(front);
			
			var back = new overlayPlane(x+5.5,y,z-2*c,3,12);
			mesh.add(back);
			
			var right = new overlayPlane(x,y,z+5.5-1.5*a,4,12);
			right.rotateY(Math.PI/2);
			mesh.add(right);
			
			var left = new overlayPlane(x,y,z+5.5+1.5*a,4,12);
			left.rotateY(+Math.PI/2);
			mesh.add(left);
			
			var top = new overlayPlane(x+5.5,y,z+6*b,3,4);
			top.rotateX(-Math.PI/2);
			mesh.add(top);
			
			var bot = new overlayPlane(x+5.5,y,z+6*b,3,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;	
		}
		function LeftArm4Overlay(x,y,z){		
			var s = 0.2;
			var a = (4+s)/4;
			var b = (12+s)/12;
			var c = (4+s)/4;

			var mesh = new THREE.Mesh();

			var front = new overlayPlane(x+6,y,z+2*c,4,12);
			mesh.add(front);
			
			var back = new overlayPlane(x+6,y,z-2*c,4,12);
			mesh.add(back);
			
			var right = new overlayPlane(x,y,z+6-1.5*a,4,12);
			right.rotateY(Math.PI/2);
			mesh.add(right);
			
			var left = new overlayPlane(x,y,z+6+1.5*a,4,12);
			left.rotateY(+Math.PI/2);
			mesh.add(left);
			
			var top = new overlayPlane(x+6,y,z+6*b,4,4);
			top.rotateX(-Math.PI/2);
			mesh.add(top);
			
			var bot = new overlayPlane(x+6,y,z+6*b,4,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;	
		}
		function CharacterLeftArm4(x,y,z){			
			var mesh = new THREE.Mesh();

			var front = new planeSide(x+6,y,z+2,4,12);
			mesh.add(front);
			
			var back = new planeSide(x+6,y,z-2,4,12);
			mesh.add(back);
			
			var right = new planeSide(x,y,z+4,4,12);
			right.rotateY(Math.PI/2);
			mesh.add(right);
			
			var left = new planeSide(x,y,z+8,4,12);
			left.rotateY(+Math.PI/2);
			mesh.add(left);
			
			var top = new planeSide(x+6,y,z+6,4,4);
			top.rotateX(-Math.PI/2);
			mesh.add(top);
			
			var bot = new planeSide(x+6,y,z+6,4,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;	
		}
		function CharacterLeftLeg(x,y,z){
			var mesh = new THREE.Mesh();

			var front = new planeSide(x+2,y-12,z+2,4,12);
			mesh.add(front);
			
			var back = new planeSide(x+2,y-12,z-2,4,12);
			mesh.add(back);
			
			var left = new planeSide(x,y-12,z+4,4,12);
			left.rotateY(+Math.PI/2);
			mesh.add(left);
			
			var right = new planeSide(x,y-12,z,4,12);
			right.rotateY(+Math.PI/2);
			mesh.add(right);
			
			var top = new planeSide(x+2,y,z+6,4,4);
			top.rotateX(Math.PI/2);
			mesh.add(top);
			
			var bot = new planeSide(x+2,y,z+18,4,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;	
		}
		function LeftLegOverlay(x,y,z){
			var s = 0.2;
			var a = (4+s)/4;
			var b = (12+s)/12;
			var c = (4+s)/4;

			var mesh = new THREE.Mesh();

			var front = new overlayPlane(x+2,y-12,z+2*c,4,12);
			mesh.add(front);
			
			var back = new overlayPlane(x+2,y-12,z-2*c,4,12);
			mesh.add(back);
			
			var left = new overlayPlane(x,y-12,z+2+2*a,4,12);
			left.rotateY(+Math.PI/2);
			mesh.add(left);
			
			var right = new overlayPlane(x,y-12,z-2+2*a,4,12);
			right.rotateY(+Math.PI/2);
			mesh.add(right);
			
			var top = new overlayPlane(x+2,y,z+12-6*b,4,4);
			top.rotateX(Math.PI/2);
			mesh.add(top);
			
			var bot = new overlayPlane(x+2,y,z+12+6*b,4,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;	
		}
		function CharacterRightLeg(x,y,z){
			var mesh = new THREE.Mesh();

			var front = new planeSide(x-2,y-12,z+2,4,12);
			mesh.add(front);
			
			var back = new planeSide(x-2,y-12,z-2,4,12);
			mesh.add(back);
			
			var right = new planeSide(x,y-12,z+4,4,12);
			right.rotateY(-Math.PI/2);
			mesh.add(right);
			
			var left = new planeSide(x,y-12,z,4,12);
			left.rotateY(-Math.PI/2);
			mesh.add(left);
			
			var top = new planeSide(x-2,y,z+6,4,4);
			top.rotateX(Math.PI/2);
			mesh.add(top);
			
			var bot = new planeSide(x-2,y,z+18,4,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;			
		}
		function RightLegOverlay(x,y,z){
			var s = 0.2;
			var a = (4+s)/4;
			var b = (12+s)/12;
			var c = (4+s)/4;

			var mesh = new THREE.Mesh();

			var front = new overlayPlane(x-2,y-12,z+2*c,4,12);
			mesh.add(front);

			var back = new overlayPlane(x-2,y-12,z-2*c,4,12);
			mesh.add(back);

			var right = new overlayPlane(x,y-12,z+2+2*a,4,12);
			right.rotateY(-Math.PI/2);
			mesh.add(right);

			var left = new overlayPlane(x,y-12,z-2+2*a,4,12);
			left.rotateY(-Math.PI/2);
			mesh.add(left);

			var top = new overlayPlane(x-2,y,z+12-6*b,4,4);
			top.rotateX(Math.PI/2);
			mesh.add(top);

			var bot = new overlayPlane(x-2,y,z+12+6*b,4,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;			
		}
		function CharacterRightArm3(x,y,z){
			var mesh = new THREE.Mesh();
			var front = new planeSide(x-5.5,y,z+2,3,12);
			mesh.add(front);
			
			var back = new planeSide(x-5.5,y,z-2,3,12);
			mesh.add(back);
			
			var left = new planeSide(x,y,z+4,4,12);
			left.rotateY(-Math.PI/2);
			mesh.add(left);

			var right = new planeSide(x,y,z+7,4,12);
			right.rotateY(-Math.PI/2);
			mesh.add(right);
			
			var top = new planeSide(x-5.5,y,z+6,3,4);
			top.rotateX(-Math.PI/2);
			mesh.add(top);
			
			var bot = new planeSide(x-5.5,y,z+6,3,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;
		}		
		function RightArm3Overlay(x,y,z){
			var s = 0.2;
			var a = (3+s)/3;
			var b = (12+s)/12;
			var c = (4+s)/4;

			var mesh = new THREE.Mesh();
			var front = new overlayPlane(x-5.5,y,z+2*c,3,12);
			mesh.add(front);

			var back = new overlayPlane(x-5.5,y,z-2*c,3,12);
			mesh.add(back);

			var left = new overlayPlane(x,y,z+5.5-1.5*a,4,12);
			left.rotateY(-Math.PI/2);
			mesh.add(left);

			var right = new overlayPlane(x,y,z+5.5+1.5*a,4,12);
			right.rotateY(-Math.PI/2);
			mesh.add(right);

			var top = new overlayPlane(x-5.5,y,z+6*b,3,4);
			top.rotateX(-Math.PI/2);
			mesh.add(top);

			var bot = new overlayPlane(x-5.5,y,z+6*b,3,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;
		}
				function RightArm4Overlay(x,y,z){
			var s = 0.2;
			var a = (4+s)/4;
			var b = (12+s)/12;
			var c = (4+s)/4;

			var mesh = new THREE.Mesh();
			var front = new overlayPlane(x-6,y,z+2*c,4,12);
			mesh.add(front);

			var back = new overlayPlane(x-6,y,z-2*c,4,12);
			mesh.add(back);

			var left = new overlayPlane(x,y,z+6-1.5*a,4,12);
			left.rotateY(-Math.PI/2);
			mesh.add(left);

			var right = new overlayPlane(x,y,z+6+1.5*a,4,12);
			right.rotateY(-Math.PI/2);
			mesh.add(right);

			var top = new overlayPlane(x-6,y,z+6*b,4,4);
			top.rotateX(-Math.PI/2);
			mesh.add(top);

			var bot = new overlayPlane(x-6,y,z+6*b,4,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;
		}
		function CharacterRightArm4(x,y,z){
			var mesh = new THREE.Mesh();
			var front = new planeSide(x-6,y,z+2,4,12);
			mesh.add(front);

			var back = new planeSide(x-6,y,z-2,4,12);
			mesh.add(back);

			var left = new planeSide(x,y,z+4,4,12);
			left.rotateY(-Math.PI/2);
			mesh.add(left);

			var right = new planeSide(x,y,z+8,4,12);
			right.rotateY(-Math.PI/2);
			mesh.add(right);

			var top = new planeSide(x-6,y,z+6,4,4);
			top.rotateX(-Math.PI/2);
			mesh.add(top);

			var bot = new planeSide(x-6,y,z+6,4,4);
			bot.rotateX(Math.PI/2);
			mesh.add(bot);

			this.mesh = mesh;
			this.top = top;
			this.bot = bot;
			this.left = left;
			this.front = front;
			this.right = right;
			this.back = back;
		}

			// function characterLeftLeg(x,y,z){

			// }
			// function characterRightLeg(x,y,z){

			// }
			function character4(x,y,z){
				var head = new characterHead(x, y+10, z);
				var body = new characterBody(x,y,z);
			}

			function CharacterBody(x,y,z){	
				var mesh = new THREE.Mesh();				

				var front = new planeSide(x,y,z+2,8,12);				
				mesh.add(front);							

				var back = new planeSide(x,y,z-2,8,12);
				mesh.add(back);
				
				var right = new planeSide(x,y,z+4,4,12);
				right.rotateY(-Math.PI/2);
				mesh.add(right);	
				
				var left = new planeSide(x,y,z+4,4,12);
				left.rotateY(Math.PI/2);
				mesh.add(left);	
				
				var top = new planeSide(x,y,z+6,8,4);
				top.rotateX(-Math.PI/2);
				mesh.add(top);
				
				var bot = new planeSide(x,y,z+6,8,4);
				bot.rotateX(+Math.PI/2);
				mesh.add(bot);		

				this.mesh = mesh;
				this.right = right;
				this.front = front;
				this.left = left;
				this.back = back;
				this.top = top;
				this.bot = bot;	
			}

			function BodyOverlay(x,y,z){	
				var s = 0.2;
				// var d = (8+s)/8;
				var a = (8+s)/8;
				var b = (12+s)/12;
				var c = (4+s)/4;
				var mesh = new THREE.Mesh();				

				var front = new overlayPlane(x,y,z+2*c,8,12);				
				mesh.add(front);							

				var back = new overlayPlane(x,y,z-2*c,8,12);
				mesh.add(back);
				
				var right = new overlayPlane(x,y,z+4*a,4,12);
				right.rotateY(-Math.PI/2);
				mesh.add(right);	
				
				var left = new overlayPlane(x,y,z+4*a,4,12);
				left.rotateY(Math.PI/2);
				mesh.add(left);	
				
				var top = new overlayPlane(x,y,z+6*b,8,4);
				top.rotateX(-Math.PI/2);
				mesh.add(top);
				
				var bot = new overlayPlane(x,y,z+6*b,8,4);
				bot.rotateX(+Math.PI/2);
				mesh.add(bot);		

				this.mesh = mesh;
				this.right = right;
				this.front = front;
				this.left = left;
				this.back = back;
				this.top = top;
				this.bot = bot;	
			}
			function CharacterHead(x,y,z){
				var mesh = new THREE.Mesh();				
				var front = new planeSide(x,y+10,z+4,8,8);
				// alert("headfront: x:"+x+",y:"+(y+10)+",z:"+(z+4));
				mesh.add(front);
				
				var back = new planeSide(x,y+10,z-4,8,8);
				mesh.add(back);
				
				var right = new planeSide(x,y+10,z+4,8,8);
				right.rotateY(-Math.PI/2);
				mesh.add(right);
				
				var left = new planeSide(x,y+10,z+4,8,8);
				left.rotateY(Math.PI/2);
				mesh.add(left);
				
				var top = new planeSide(x,y,z+14,8,8);
				top.rotateX(-Math.PI/2);
				mesh.add(top);
				
				var bot = new planeSide(x,y,z+6,8,8);
				bot.rotateX(-Math.PI/2);
				mesh.add(bot);

				this.mesh = mesh;
				this.right = right;
				this.front = front;
				this.left = left;
				this.back = back;
				this.top = top;
				this.bot = bot;
				// return mesh;
			}

			function HeadOverlay(x,y,z){
				var s = 0.2;
				var d = (8+s)/8;
				var mesh = new THREE.Mesh();				
				var front = new overlayPlane(x,y+10,z+4*d,8,8);
				// alert("headoverlayfront: x:"+x+",y:"+(y+10)+",z:"+(z+4*d));
				mesh.add(front);
				
				var back = new overlayPlane(x,y+10,z-4*d,8,8);
				mesh.add(back);
				
				var right = new overlayPlane(x,y+10,z+4*d,8,8);
				right.rotateY(-Math.PI/2);
				mesh.add(right);
				
				var left = new overlayPlane(x,y+10,z+4*d,8,8);
				left.rotateY(Math.PI/2);
				mesh.add(left);
				
				var top = new overlayPlane(x,y,z+10+4*d,8,8);
				top.rotateX(-Math.PI/2);
				mesh.add(top);
				
				var bot = new overlayPlane(x,y,z+10-4*d,8,8);
				bot.rotateX(-Math.PI/2);
				mesh.add(bot);

				this.mesh = mesh;
				this.right = right;
				this.front = front;
				this.left = left;
				this.back = back;
				this.top = top;
				this.bot = bot;
				// return mesh;
			}

		function planeSide(x,y,z,m,n){ // m,n are width and height of the side
			var mesh = new THREE.Mesh();
			for( var i = 0; i < n;i++){				
				for(var j = 0; j < m ; j++){
					var plane = planeCell(x-m/2+j+0.5,y+n/2-i-0.5,z);
					mesh.add(plane);
				}		
			}
			return mesh;
		}
				function overlayPlane(x,y,z,m,n){ // m,n are width and height of the side
					var mesh = new THREE.Mesh();
					var s = 0.2;
					var a = (m+s)/m;
					var b = (n+s)/n;
					for( var i = 0; i < n;i++){				
						for(var j = 0; j < m ; j++){
							var plane = overlayCell(x-(m/2-j-0.5)*a,y+(n/2-i-0.5)*b,z,a,b);
							mesh.add(plane);
						}		
					}
					return mesh;
				}
				function overlayCell(x,y,z,a,b){						
					// 0xCCCCCC
					var geometry = new THREE.PlaneGeometry( a, b);
					material = new THREE.MeshBasicMaterial( { color: 0xcccccc, side: THREE.DoubleSide, opacity: 0, transparent: true } );
					var plane = new THREE.Mesh( geometry, material );			
					plane.position.x = x;
					plane.position.y = y;
					plane.position.z = z;
					plane.renderOrder = 10;
					scene.add( plane );// plane.rotateX(5);
					objects.push(plane);										
					return plane;
				}

				function planeCell(x,y,z){	

					var geometry = new THREE.PlaneGeometry( 1, 1);			
					material = new THREE.MeshBasicMaterial( { color: 0xCCCCCC, side: THREE.DoubleSide, opacity: 0.8, transparent: true } );
					var plane = new THREE.Mesh( geometry, material );			
					plane.position.x = x;
					plane.position.y = y;
					plane.position.z = z;
					plane.renderOrder = 10;
					scene.add( plane );
					objects.push(plane);										
					return plane;
				}
				function onMouseDown(event){
					paintState =0;
					cameraControls.enabled = true;			

					var penColor = $('#picker').colorpicker('getValue', 0xffff00);	

					var canvasPosition = renderer.domElement.getBoundingClientRect();				
					mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
					mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

					raycaster.setFromCamera( mouse, camera );
					var intersects = raycaster.intersectObjects( objects );
					if(penState==1){
						if(intersects.length>0) {	
							cameraControls.enabled = false;
							paintState =1;
							intersects[ 0 ].object.material =new THREE.MeshBasicMaterial( { color: penColor, side: THREE.DoubleSide } );						
						}	
					}
					if(areaPaintState ==1){
						if(intersects.length>0) {	
							for( var j = 0; j< intersects[ 0 ].object.parent.children.length; j++){		
								paintState =1;
								cameraControls.enabled = false;														
								intersects[ 0 ].object.parent.children[j].material =new THREE.MeshBasicMaterial( { color: penColor, side: THREE.DoubleSide } );	
							}
						}
					}
					if(eraseState ==1){
						if(intersects.length>0) {	
							cameraControls.enabled = false;
							paintState =1;
							intersects[ 0 ].object.material = new THREE.MeshBasicMaterial( { color: 0xCCCCCC, side: THREE.DoubleSide, opacity: 0, transparent: true } );		
						}
					}
				}
				function onMouseUp(event){
					paintState =0;
				}

				function onMouseMove(event){				
					if(paintState ==1)	{
						if(penState==1){
							var penColor = $('#picker').colorpicker('getValue', 0xffff00);					
							var canvasPosition = renderer.domElement.getBoundingClientRect();
							mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
							mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;



							raycaster.setFromCamera( mouse, camera );
							var intersects = raycaster.intersectObjects( objects );

							if(intersects.length>0) {		
								cameraControls.enabled = false;										
								intersects[ 0 ].object.material =new THREE.MeshBasicMaterial( { color: penColor, side: THREE.DoubleSide } );						 
							}	
						}
						else if (eraseState ==1 ) {
							var penColor = $('#picker').colorpicker('getValue', 0xffff00);					
							var canvasPosition = renderer.domElement.getBoundingClientRect();
							mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
							mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

							raycaster.setFromCamera( mouse, camera );
							var intersects = raycaster.intersectObjects( objects );

							if(intersects.length>0) {		
								cameraControls.enabled = false;										
								intersects[ 0 ].object.material =new THREE.MeshBasicMaterial( { color: 0xCCCCCC, side: THREE.DoubleSide, opacity: 0, transparent: true } );						 
							}	
						}
					}
				}

				function onWindowResize() {
			// windowHalfX = WIDTH / 2;
			// windowHalfY = HEIGHT / 2;
			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();
			// renderer.setSize( WIDTH, HEIGHT );
			renderer.setSize( window.innerWidth, window.innerHeight );
		}


		function render () {
			requestAnimationFrame( render );



			renderer.render( scene, camera );						
			// renderer.render(scene, camera);
		};
		function headClick(){			
			
			if(headState ==0){				
				document.getElementById('head').style.backgroundColor = SCENECOLOR;
				// document.getElementById('head').style.backgroundColor = 'lightyellow';
				// $('#head').css('color', 'red');
				headState =1;
				// model.head.visible = false;				
				// model.headBorder.visible = false;
				model.headBox.translateX(100000);
				// model.headBorder.translateX(-100000);				
			}else{
				document.getElementById('head').style.backgroundColor = OUTLINECOLOR;
				headState =0;
				// model.head.visible = true;
				// model.headBorder.visible = true;	
				model.headBox.translateX(-100000);
				// model.headBorder.translateX(100000);
			}
		}
		function bodyClick(){
			if(bodyState ==0){
				document.getElementById('body').style.backgroundColor = SCENECOLOR;
				bodyState =1;
				// model.head.visible = false;				
				// model.headBorder.visible = false;
				model.body.translateX(100000);
				model.bodyOverlay.translateX(100000);
				model.bodyBorder.translateX(100000);
			}else{
				document.getElementById('body').style.backgroundColor = OUTLINECOLOR;
				bodyState =0;
				// model.head.visible = true;
				// model.headBorder.visible = true;	
				model.body.translateX(-100000);
				model.bodyOverlay.translateX(-100000);
				model.bodyBorder.translateX(-100000);
			}
		}
		
		function leftArmClick(){
			if(leftArmState ==0){
				document.getElementById('leftArm').style.backgroundColor = SCENECOLOR;
				leftArmState =1;
				model.leftArmBox.translateX(100000);
				
			}else{
				document.getElementById('leftArm').style.backgroundColor = OUTLINECOLOR;
				leftArmState =0;
				model.leftArmBox.translateX(-100000);
				
			}
		}
		function rightArmClick(){
			if(rightArmState ==0){
				document.getElementById('rightArm').style.backgroundColor = SCENECOLOR;
				rightArmState =1;
				model.rightArmBox.translateX(100000);				
			}else{
				document.getElementById('rightArm').style.backgroundColor = OUTLINECOLOR;
				rightArmState =0;
				model.rightArmBox.translateX(-100000);				
			}
		}
		function leftLegClick(){
			if(leftLegState ==0){
				document.getElementById('leftLeg').style.backgroundColor = SCENECOLOR;
				leftLegState =1;
				model.leftLegBox.translateX(100000);
			}else{
				document.getElementById('leftLeg').style.backgroundColor = OUTLINECOLOR;
				leftLegState =0;
				model.leftLegBox.translateX(-100000);
			}
		}
		function rightLegClick(){
			document.getElementById('rightLeg').style.backgroundColor = SCENECOLOR;
			if(rightLegState ==0){
				rightLegState =1;
				model.rightLegBox.translateX(100000);
			}else{
				document.getElementById('rightLeg').style.backgroundColor = OUTLINECOLOR;
				rightLegState =0;			
				model.rightLegBox.translateX(-100000);
			}
		}
		function areaPaint(){					
			areaPaintState =1;
			eraseState =0;
			penState =0;				
		}	
		function erase(){	
			eraseState =1;
			penState =0;				
			areaPaintState =0;
		}
		function usepen(){		
			penState =1;
			areaPaintState =0;
			eraseState =0;	
		}
		function draw(){
			//draw body
			var c = document.getElementById("myCanvas");
			var ctx = c.getContext("2d");

			// 2D head
			for(var n = 0; n<model.headTop.children.length;n++){
				var hex = model.headTop.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(8+xpos,ypos,1,1);
				// alert(n);
			}
			for(var n = 0; n<model.headBot.children.length;n++){
				var hex = model.headBot.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(16+xpos,ypos,1,1);
				// alert(n);
			}
			for(var n = 0; n<model.headRight.children.length;n++){
				var hex = model.headRight.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(0+xpos,8+ypos,1,1);
				// alert(n);
			}
			for(var n = 0; n<model.headFront.children.length;n++){
				var hex = model.headFront.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(8+xpos,8+ypos,1,1);
				// alert(n);
			}
			for(var n = 0; n<model.headLeft.children.length;n++){
				var hex = model.headLeft.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(16+xpos,8+ypos,1,1);
				// alert(n);
			}
			for(var n = 0; n<model.headBack.children.length;n++){
				var hex = model.headBack.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(24+xpos,8+ypos,1,1);				
			}

			// 2D headOverlay
			for(var n = 0; n<model.headTopOverlay.children.length;n++){
				var hex = model.headTopOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(32+8+xpos,ypos,1,1);
				// alert(n);
			}
			for(var n = 0; n<model.headBotOverlay.children.length;n++){
				var hex = model.headBotOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(32+16+xpos,ypos,1,1);
				// alert(n);
			}
			for(var n = 0; n<model.headRightOverlay.children.length;n++){
				var hex = model.headRightOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(32+0+xpos,8+ypos,1,1);
				// alert(n);
			}
			for(var n = 0; n<model.headFrontOverlay.children.length;n++){
				var hex = model.headFrontOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(32+8+xpos,8+ypos,1,1);
				// alert(n);
			}
			for(var n = 0; n<model.headLeftOverlay.children.length;n++){
				var hex = model.headLeftOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(32+16+xpos,8+ypos,1,1);
				// alert(n);
			}
			for(var n = 0; n<model.headBackOverlay.children.length;n++){
				var hex = model.headBackOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(32+24+xpos,8+ypos,1,1);				
			}
			//2D right leg
			model.rightLegBot.children.reverse();
			for(var n = 0; n<model.rightLegBot.children.length;n++){
				var hex = model.rightLegBot.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(11-xpos,16+ypos,1,1);				
			}
			model.rightLegTop.children.reverse();
			for(var n = 0; n<model.rightLegTop.children.length;n++){
				var hex = model.rightLegTop.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(7-xpos,16+ypos,1,1);				
			}
			for(var n = 0; n<model.rightLegRight.children.length;n++){
				var hex = model.rightLegRight.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(0+xpos,20+ypos,1,1);				
			}
			for(var n = 0; n<model.rightLegFront.children.length;n++){
				var hex = model.rightLegFront.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(4+xpos,20+ypos,1,1);				
			}
			for(var n = 0; n<model.rightLegLeft.children.length;n++){
				var hex = model.rightLegLeft.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(11-xpos,20+ypos,1,1);				
			}
			for(var n = 0; n<model.rightLegBack.children.length;n++){
				var hex = model.rightLegBack.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(15-xpos,20+ypos,1,1);				
			}
			//2D right leg overlay
			model.rightLegBotOverlay.children.reverse();
			for(var n = 0; n<model.rightLegBotOverlay.children.length;n++){
				var hex = model.rightLegBotOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(11-xpos,16+ypos+16,1,1);				
			}
			model.rightLegTopOverlay.children.reverse();
			for(var n = 0; n<model.rightLegTopOverlay.children.length;n++){
				var hex = model.rightLegTopOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(7-xpos,16+ypos+16,1,1);				
			}
			for(var n = 0; n<model.rightLegRightOverlay.children.length;n++){
				var hex = model.rightLegRightOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(0+xpos,20+ypos+16,1,1);				
			}
			for(var n = 0; n<model.rightLegFrontOverlay.children.length;n++){
				var hex = model.rightLegFrontOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(4+xpos,20+ypos+16,1,1);				
			}
			for(var n = 0; n<model.rightLegLeftOverlay.children.length;n++){
				var hex = model.rightLegLeftOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(11-xpos,20+ypos+16,1,1);				
			}
			for(var n = 0; n<model.rightLegBackOverlay.children.length;n++){
				var hex = model.rightLegBackOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(15-xpos,20+ypos+16,1,1);				
			}
			//2D leftleg
			model.leftLegTop.children.reverse();
			for(var n = 0; n<model.leftLegTop.children.length;n++){
				var hex = model.leftLegTop.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(23-xpos,48+ypos,1,1);				
			}
			model.leftLegBot.children.reverse();
			for(var n = 0; n<model.leftLegBot.children.length;n++){
				var hex = model.leftLegBot.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(27-xpos,48+ypos,1,1);				
			}
			for(var n = 0; n<model.leftLegRight.children.length;n++){
				var hex = model.leftLegRight.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(19-xpos,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftLegFront.children.length;n++){
				var hex = model.leftLegFront.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(20+xpos,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftLegLeft.children.length;n++){
				var hex = model.leftLegLeft.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(24+xpos,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftLegBack.children.length;n++){
				var hex = model.leftLegBack.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(31-xpos,52+ypos,1,1);			
			}
			//2D leftlegOverlay
			model.leftLegTopOverlay.children.reverse();
			for(var n = 0; n<model.leftLegTopOverlay.children.length;n++){
				var hex = model.leftLegTopOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(23-xpos-16,48+ypos,1,1);				
			}
			model.leftLegBotOverlay.children.reverse();
			for(var n = 0; n<model.leftLegBotOverlay.children.length;n++){
				var hex = model.leftLegBotOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(27-xpos-16,48+ypos,1,1);				
			}
			for(var n = 0; n<model.leftLegRightOverlay.children.length;n++){
				var hex = model.leftLegRightOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(19-xpos-16,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftLegFrontOverlay.children.length;n++){
				var hex = model.leftLegFrontOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(20+xpos-16,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftLegLeftOverlay.children.length;n++){
				var hex = model.leftLegLeftOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(24+xpos-16,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftLegBackOverlay.children.length;n++){
				var hex = model.leftLegBackOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(31-xpos-16,52+ypos,1,1);			
			}

			// 2d body
			for(var n = 0; n<model.bodyTop.children.length;n++){
				var hex = model.bodyTop.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);				
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(20+xpos,16+ypos,1,1);				
			}
			model.bodyBot.children.reverse();
			for(var n = 0; n<model.bodyBot.children.length;n++){
				var hex = model.bodyBot.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);				
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(35-xpos,16+ypos,1,1);				
			}
			for(var n = 0; n<model.bodyRight.children.length;n++){
				var hex = model.bodyRight.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(16+xpos,20+ypos,1,1);				
			}
			for(var n = 0; n<model.bodyFront.children.length;n++){
				var hex = model.bodyFront.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);				
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(20+xpos,20+ypos,1,1);				
			}
			for(var n = 0; n<model.bodyBack.children.length;n++){
				var hex = model.bodyBack.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(39-xpos,20+ypos,1,1);				
			}
			for(var n = 0; n<model.bodyLeft.children.length;n++){
				var hex = model.bodyLeft.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(28+xpos,20+ypos,1,1);				
			}
			// 2d bodyOverlay
			for(var n = 0; n<model.bodyTopOverlay.children.length;n++){
				var hex = model.bodyTopOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);				
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(20+xpos,16+ypos+16,1,1);				
			}
			model.bodyBotOverlay.children.reverse();
			for(var n = 0; n<model.bodyBotOverlay.children.length;n++){
				var hex = model.bodyBotOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);				
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(35-xpos,16+ypos+16,1,1);				
			}
			for(var n = 0; n<model.bodyRightOverlay.children.length;n++){
				var hex = model.bodyRightOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(16+xpos,20+ypos+16,1,1);				
			}
			for(var n = 0; n<model.bodyFrontOverlay.children.length;n++){
				var hex = model.bodyFrontOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);				
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(20+xpos,20+ypos+16,1,1);				
			}
			for(var n = 0; n<model.bodyBackOverlay.children.length;n++){
				var hex = model.bodyBackOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%8;
				var ypos = Math.floor(n/8);
				ctx.fillRect(39-xpos,20+ypos+16,1,1);				
			}
			for(var n = 0; n<model.bodyLeftOverlay.children.length;n++){
				var hex = model.bodyLeftOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(28+xpos,20+ypos+16,1,1);				
			}
			//2D right arm
			for(var n = 0; n<model.rightArmTop.children.length;n++){
				var hex = model.rightArmTop.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(44+xpos,16+ypos,1,1);				
			}
			model.rightArmBot.children.reverse();
			for(var n = 0; n<model.rightArmBot.children.length;n++){
				var hex = model.rightArmBot.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(49-xpos,16+ypos,1,1);				
			}
			for(var n = 0; n<model.rightArmRight.children.length;n++){
				var hex = model.rightArmRight.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(40+xpos,20+ypos,1,1);				
			}
			for(var n = 0; n<model.rightArmFront.children.length;n++){
				var hex = model.rightArmFront.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(44+xpos,20+ypos,1,1);				
			}
			for(var n = 0; n<model.rightArmLeft.children.length;n++){
				var hex = model.rightArmLeft.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(50-xpos,20+ypos,1,1);				
			}
			for(var n = 0; n<model.rightArmBack.children.length;n++){
				var hex = model.rightArmBack.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(53-xpos,20+ypos,1,1);				
			}
			//2D right arm overlay
			for(var n = 0; n<model.rightArmTopOverlay.children.length;n++){
				var hex = model.rightArmTopOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(44+xpos,16+ypos+16,1,1);				
			}
			model.rightArmBotOverlay.children.reverse();
			for(var n = 0; n<model.rightArmBotOverlay.children.length;n++){
				var hex = model.rightArmBotOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(49-xpos,16+ypos+16,1,1);				
			}
			for(var n = 0; n<model.rightArmRightOverlay.children.length;n++){
				var hex = model.rightArmRightOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(40+xpos,20+ypos+16,1,1);				
			}
			for(var n = 0; n<model.rightArmFrontOverlay.children.length;n++){
				var hex = model.rightArmFrontOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(44+xpos,20+ypos+16,1,1);				
			}
			for(var n = 0; n<model.rightArmLeftOverlay.children.length;n++){
				var hex = model.rightArmLeftOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(50-xpos,20+ypos+16,1,1);				
			}
			for(var n = 0; n<model.rightArmBackOverlay.children.length;n++){
				var hex = model.rightArmBackOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(53-xpos,20+ypos+16,1,1);				
			}
			//2D left arm
			for(var n = 0; n<model.leftArmTop.children.length;n++){
				var hex = model.leftArmTop.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(36+xpos,48+ypos,1,1);				
			}


			model.leftArmBot.children.reverse();
			for(var n = 0; n<model.leftArmBot.children.length;n++){
				var hex = model.leftArmBot.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(41-xpos,48+ypos,1,1);				
			}
			for(var n = 0; n<model.leftArmRight.children.length;n++){
				var hex = model.leftArmRight.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(35-xpos,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftArmFront.children.length;n++){
				var hex = model.leftArmFront.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(36+xpos,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftArmLeft.children.length;n++){
				var hex = model.leftArmLeft.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(39+xpos,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftArmBack.children.length;n++){
				var hex = model.leftArmBack.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(45-xpos,52+ypos,1,1);				
			}
			//2D left arm overlay
			for(var n = 0; n<model.leftArmTopOverlay.children.length;n++){
				var hex = model.leftArmTopOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(36+xpos+14,48+ypos,1,1);				
			}


			model.leftArmBotOverlay.children.reverse();
			for(var n = 0; n<model.leftArmBotOverlay.children.length;n++){
				var hex = model.leftArmBotOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(41-xpos+14,48+ypos,1,1);				
			}
			for(var n = 0; n<model.leftArmRightOverlay.children.length;n++){
				var hex = model.leftArmRightOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(35-xpos+14,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftArmFrontOverlay.children.length;n++){
				var hex = model.leftArmFrontOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(36+xpos+14,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftArmLeftOverlay.children.length;n++){
				var hex = model.leftArmLeftOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%4;
				var ypos = Math.floor(n/4);
				ctx.fillRect(39+xpos+14,52+ypos,1,1);				
			}
			for(var n = 0; n<model.leftArmBackOverlay.children.length;n++){
				var hex = model.leftArmBackOverlay.children[n].material.color.getHex();		
				// Create gradient
				var grd = ctx.createLinearGradient(0,0,100,0);
				var hexstring = hex.toString(16);
				if(hexstring.length<6){	
					var len = hexstring.length;
					for (i=0; i< 6 - len;i++){		
						hexstring='0'+hexstring;		
					}
				}
				hexstring = '#'+hexstring;
				grd.addColorStop(0,hexstring);
				grd.addColorStop(1,hexstring);
				// grd.addColorStop(1,'rgb($r, $g, $b)');
				// Fill with gradient
				ctx.fillStyle = grd;
				var xpos = n%3;
				var ypos = Math.floor(n/3);
				ctx.fillRect(45-xpos+14,52+ypos,1,1);				
			}
			
		}
		function download() {
			draw();
			var canvas = document.getElementById('myCanvas');
			var dt = canvas.toDataURL();
			this.href = dt;
		}
		document.getElementById('download').addEventListener('click', download, false);
		function upload(){

			var selectedFile = document.getElementById('skin-image-file').files[0];		
			
			// var myTexture = new THREE.TextureLoader().load(selectedFile.name);
			var skinfile = URL.createObjectURL(selectedFile);
			//var skinfile = "file:///C:/Users/Admin/Desktop/skin/minecraftskin(14).png";
			alert(selectedFile.name);
			alert(skinfile);
			//var skinfile = "file:///C:/Users/Admin/Desktop/skin/signaturettt.png";
			// var skinfile = "grau.png";
			var myTexture = new THREE.TextureLoader().load(skinfile);

			//alert(skinfile);
			var material = new THREE.MeshBasicMaterial({map: myTexture, side:THREE.DoubleSide });

			var s = 1/8;    
			var r = 1/64;
			// var s = 0.125;
			// var r = 0.015625;
			//upload headtop
			for(var i=0; i<model.headTop.children.length;i++){
				var mygeometry = model.headTop.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set( s + xpos*r, 1-r  - ypos*r );
				uvs[ 0 ][ 1 ].set( s + xpos*r, 1 - ypos*r);
				uvs[ 0 ][ 2 ].set( s+r + xpos*r, 1  - ypos*r);
				uvs[ 1 ][ 0 ].set( s + xpos*r, 1-r  - ypos*r);
				uvs[ 1 ][ 1 ].set( s+r + xpos*r, 1-r - ypos*r);
				uvs[ 1 ][ 2 ].set( s+r + xpos*r, 1 - ypos*r);

				model.headTop.children[i].material = material;
			}

			//upload headBot

			for(var i=0; i<64;i++){
				var mygeometry = model.headBot.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set( 2*s + xpos*r, 1 - ypos*r);
				uvs[ 0 ][ 1 ].set( 2*s + xpos*r, 1-r  - ypos*r);
				uvs[ 0 ][ 2 ].set( 2*s+r + xpos*r, 1  - ypos*r);
				uvs[ 1 ][ 0 ].set( 2*s + xpos*r, 1-r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 2*s+r + xpos*r, 1-r - ypos*r);
				uvs[ 1 ][ 2 ].set( 2*s+r + xpos*r, 1 - ypos*r);

				model.headBot.children[i].material = material;
			}

			//upload headright
			for(var i=0; i<64;i++){
				var mygeometry = model.headRight.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set( xpos*r, 1 - ypos*r - s);
				uvs[ 0 ][ 1 ].set( xpos*r, 1-r  - ypos*r - s);
				uvs[ 0 ][ 2 ].set( r + xpos*r, 1  - ypos*r - s);
				uvs[ 1 ][ 0 ].set( xpos*r, 1-r  - ypos*r - s);
				uvs[ 1 ][ 1 ].set( r + xpos*r, 1-r - ypos*r - s);
				uvs[ 1 ][ 2 ].set( r + xpos*r, 1 - ypos*r - s);

				model.headRight.children[i].material = material;
			}			
			//upload headFront
			for(var i=0; i<64;i++){
				var mygeometry = model.headFront.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set(s+ xpos*r, 1 - ypos*r - s);
				uvs[ 0 ][ 1 ].set(s+ xpos*r, 1-r  - ypos*r - s);
				uvs[ 0 ][ 2 ].set(s+ r + xpos*r, 1  - ypos*r - s);
				uvs[ 1 ][ 0 ].set(s+ xpos*r, 1-r  - ypos*r - s);
				uvs[ 1 ][ 1 ].set(s+ r + xpos*r, 1-r - ypos*r - s);
				uvs[ 1 ][ 2 ].set(s+ r + xpos*r, 1 - ypos*r - s);

				model.headFront.children[i].material = material;
			}	
			//upload headLeft
			for(var i=0; i<64;i++){
				var mygeometry = model.headLeft.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set(2*s+ xpos*r, 1 - ypos*r - s);
				uvs[ 0 ][ 1 ].set(2*s+ xpos*r, 1-r  - ypos*r - s);
				uvs[ 0 ][ 2 ].set(2*s+ r + xpos*r, 1  - ypos*r - s);
				uvs[ 1 ][ 0 ].set(2*s+ xpos*r, 1-r  - ypos*r - s);
				uvs[ 1 ][ 1 ].set(2*s+ r + xpos*r, 1-r - ypos*r - s);
				uvs[ 1 ][ 2 ].set(2*s+ r + xpos*r, 1 - ypos*r - s);

				model.headLeft.children[i].material = material;
			}	
			//upload headBack

			for(var i=0; i<64;i++){
				var mygeometry = model.headBack.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set(3*s+ xpos*r, 1 - ypos*r - s);
				uvs[ 0 ][ 1 ].set(3*s+ xpos*r, 1-r  - ypos*r - s);
				uvs[ 0 ][ 2 ].set(3*s+ r + xpos*r, 1  - ypos*r - s);
				uvs[ 1 ][ 0 ].set(3*s+ xpos*r, 1-r  - ypos*r - s);
				uvs[ 1 ][ 1 ].set(3*s+ r + xpos*r, 1-r - ypos*r - s);
				uvs[ 1 ][ 2 ].set(3*s+ r + xpos*r, 1 - ypos*r - s);

				model.headBack.children[i].material = material;
			}


			//upload headtopoverlay
			for(var i=0; i<model.headTopOverlay.children.length;i++){
				var mygeometry = model.headTopOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set( s + xpos*r+4*s, 1-r  - ypos*r );
				uvs[ 0 ][ 1 ].set( s + xpos*r+4*s, 1 - ypos*r);
				uvs[ 0 ][ 2 ].set( s+r + xpos*r+4*s, 1  - ypos*r);
				uvs[ 1 ][ 0 ].set( s + xpos*r+4*s, 1-r  - ypos*r);
				uvs[ 1 ][ 1 ].set( s+r + xpos*r+4*s, 1-r - ypos*r);
				uvs[ 1 ][ 2 ].set( s+r + xpos*r+4*s, 1 - ypos*r);

				model.headTopOverlay.children[i].material = material;
			}

			//upload headBotOverlay

			for(var i=0; i<64;i++){
				var mygeometry = model.headBotOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set( 2*s + xpos*r+4*s, 1 - ypos*r);
				uvs[ 0 ][ 1 ].set( 2*s + xpos*r+4*s, 1-r  - ypos*r);
				uvs[ 0 ][ 2 ].set( 2*s+r + xpos*r+4*s, 1  - ypos*r);
				uvs[ 1 ][ 0 ].set( 2*s + xpos*r+4*s, 1-r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 2*s+r + xpos*r+4*s, 1-r - ypos*r);
				uvs[ 1 ][ 2 ].set( 2*s+r + xpos*r+4*s, 1 - ypos*r);

				model.headBotOverlay.children[i].material = material;
			}

			//upload headRightOverlay
			for(var i=0; i<64;i++){
				var mygeometry = model.headRightOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set( xpos*r+4*s, 1 - ypos*r - s);
				uvs[ 0 ][ 1 ].set( xpos*r+4*s, 1-r  - ypos*r - s);
				uvs[ 0 ][ 2 ].set( r + xpos*r+4*s, 1  - ypos*r - s);
				uvs[ 1 ][ 0 ].set( xpos*r+4*s, 1-r  - ypos*r - s);
				uvs[ 1 ][ 1 ].set( r + xpos*r+4*s, 1-r - ypos*r - s);
				uvs[ 1 ][ 2 ].set( r + xpos*r+4*s, 1 - ypos*r - s);

				model.headRightOverlay.children[i].material = material;
			}			
			//upload headFrontOverlay
			for(var i=0; i<64;i++){
				var mygeometry = model.headFrontOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set(s+ xpos*r+4*s, 1 - ypos*r - s);
				uvs[ 0 ][ 1 ].set(s+ xpos*r+4*s, 1-r  - ypos*r - s);
				uvs[ 0 ][ 2 ].set(s+ r + xpos*r+4*s, 1  - ypos*r - s);
				uvs[ 1 ][ 0 ].set(s+ xpos*r+4*s, 1-r  - ypos*r - s);
				uvs[ 1 ][ 1 ].set(s+ r + xpos*r+4*s, 1-r - ypos*r - s);
				uvs[ 1 ][ 2 ].set(s+ r + xpos*r+4*s, 1 - ypos*r - s);

				model.headFrontOverlay.children[i].material = material;
			}	
			//upload headLeftOverlay
			for(var i=0; i<64;i++){
				var mygeometry = model.headLeftOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set(2*s+ xpos*r+4*s, 1 - ypos*r - s);
				uvs[ 0 ][ 1 ].set(2*s+ xpos*r+4*s, 1-r  - ypos*r - s);
				uvs[ 0 ][ 2 ].set(2*s+ r + xpos*r+4*s, 1  - ypos*r - s);
				uvs[ 1 ][ 0 ].set(2*s+ xpos*r+4*s, 1-r  - ypos*r - s);
				uvs[ 1 ][ 1 ].set(2*s+ r + xpos*r+4*s, 1-r - ypos*r - s);
				uvs[ 1 ][ 2 ].set(2*s+ r + xpos*r+4*s, 1 - ypos*r - s);

				model.headLeftOverlay.children[i].material = material;
			}	
			//upload headBackOverlay

			for(var i=0; i<64;i++){
				var mygeometry = model.headBackOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);

				uvs[ 0 ][ 0 ].set(3*s+ xpos*r+4*s, 1 - ypos*r - s);
				uvs[ 0 ][ 1 ].set(3*s+ xpos*r+4*s, 1-r  - ypos*r - s);
				uvs[ 0 ][ 2 ].set(3*s+ r + xpos*r+4*s, 1  - ypos*r - s);
				uvs[ 1 ][ 0 ].set(3*s+ xpos*r+4*s, 1-r  - ypos*r - s);
				uvs[ 1 ][ 1 ].set(3*s+ r + xpos*r+4*s, 1-r - ypos*r - s);
				uvs[ 1 ][ 2 ].set(3*s+ r + xpos*r+4*s, 1 - ypos*r - s);

				model.headBackOverlay.children[i].material = material;
			}

			//upload bodyTop
			for(var i=0; i<32;i++){
				var mygeometry = model.bodyTop.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);
				uvs[ 0 ][ 0 ].set( 2.5*s + xpos*r, 1 - 2*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 2.5*s + xpos*r, 1 - 2*s - r  - ypos*r);
				uvs[ 0 ][ 2 ].set( 2.5*s+r + xpos*r, 1 - 2*s  - ypos*r);
				uvs[ 1 ][ 0 ].set( 2.5*s + xpos*r, 1 - 2*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 2.5*s+r + xpos*r, 1 - 2*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 2.5*s+r + xpos*r, 1 - 2*s - ypos*r);

				model.bodyTop.children[i].material = material;
			}
			//upload bodyBot
			for(var i=0; i<32;i++){
				var mygeometry = model.bodyBot.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);
				uvs[ 0 ][ 0 ].set( 3.5*s + xpos*r, 1 - 2*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 3.5*s + xpos*r, 1 - 2*s - r  - ypos*r);
				uvs[ 0 ][ 2 ].set( 3.5*s+r + xpos*r, 1 - 2*s  - ypos*r);
				uvs[ 1 ][ 0 ].set( 3.5*s + xpos*r, 1 - 2*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 3.5*s+r + xpos*r, 1 - 2*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 3.5*s+r + xpos*r, 1 - 2*s - ypos*r);

				model.bodyBot.children[i].material = material;
			}

			//upload bodyRight
			for(var i=0; i<48;i++){
				var mygeometry = model.bodyRight.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);
				uvs[ 0 ][ 0 ].set( 2*s + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 2*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 0 ][ 2 ].set( 2*s+r + xpos*r, 1 - 2.5*s  - ypos*r);
				uvs[ 1 ][ 0 ].set( 2*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 2*s+r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 2*s+r + xpos*r, 1 - 2.5*s - ypos*r);

				model.bodyRight.children[i].material = material;
			}

			//upload bodyFront
			for(var i=0; i<96;i++){
				var mygeometry = model.bodyFront.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);
				uvs[ 0 ][ 0 ].set( 2.5*s + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 2.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 0 ][ 2 ].set( 2.5*s+r + xpos*r, 1 - 2.5*s  - ypos*r);
				uvs[ 1 ][ 0 ].set( 2.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 2.5*s+r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 2.5*s+r + xpos*r, 1 - 2.5*s - ypos*r);

				model.bodyFront.children[i].material = material;
			}
			//upload bodyLeft
			for(var i=0; i<48;i++){
				var mygeometry = model.bodyLeft.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);
				uvs[ 0 ][ 0 ].set( 3.5*s + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 3.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 0 ][ 2 ].set( 3.5*s+r + xpos*r, 1 - 2.5*s  - ypos*r);
				uvs[ 1 ][ 0 ].set( 3.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 3.5*s+r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 3.5*s+r + xpos*r, 1 - 2.5*s - ypos*r);

				model.bodyLeft.children[i].material = material;
			}
			//upload bodyBack
			for(var i=0; i<96;i++){
				var mygeometry = model.bodyBack.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);
				uvs[ 0 ][ 0 ].set( 4*s + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 4*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 0 ][ 2 ].set( 4*s+r + xpos*r, 1 - 2.5*s  - ypos*r);
				uvs[ 1 ][ 0 ].set( 4*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 4*s+r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 4*s+r + xpos*r, 1 - 2.5*s - ypos*r);

				model.bodyBack.children[i].material = material;
			}

			//upload bodyTopOverlay
			for(var i=0; i<32;i++){
				var mygeometry = model.bodyTopOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);
				uvs[ 0 ][ 0 ].set( 2.5*s + xpos*r, 1 - 2*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( 2.5*s + xpos*r, 1 - 2*s - r  - ypos*r-2*s);
				uvs[ 0 ][ 2 ].set( 2.5*s+r + xpos*r, 1 - 2*s  - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( 2.5*s + xpos*r, 1 - 2*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( 2.5*s+r + xpos*r, 1 - 2*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( 2.5*s+r + xpos*r, 1 - 2*s - ypos*r-2*s);

				model.bodyTopOverlay.children[i].material = material;
			}
			//upload bodyBotOverlay
			for(var i=0; i<32;i++){
				var mygeometry = model.bodyBotOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);
				uvs[ 0 ][ 0 ].set( 3.5*s + xpos*r, 1 - 2*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( 3.5*s + xpos*r, 1 - 2*s - r  - ypos*r-2*s);
				uvs[ 0 ][ 2 ].set( 3.5*s+r + xpos*r, 1 - 2*s  - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( 3.5*s + xpos*r, 1 - 2*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( 3.5*s+r + xpos*r, 1 - 2*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( 3.5*s+r + xpos*r, 1 - 2*s - ypos*r-2*s);

				model.bodyBotOverlay.children[i].material = material;
			}

			//upload bodyRightOverlay
			for(var i=0; i<48;i++){
				var mygeometry = model.bodyRightOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);
				uvs[ 0 ][ 0 ].set( 2*s + xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( 2*s + xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 0 ][ 2 ].set( 2*s+r + xpos*r, 1 - 2.5*s  - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( 2*s + xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( 2*s+r + xpos*r, 1 - 2.5*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( 2*s+r + xpos*r, 1 - 2.5*s - ypos*r-2*s);

				model.bodyRightOverlay.children[i].material = material;
			}

			//upload bodyFrontOverlay
			for(var i=0; i<96;i++){
				var mygeometry = model.bodyFrontOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);
				uvs[ 0 ][ 0 ].set( 2.5*s + xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( 2.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 0 ][ 2 ].set( 2.5*s+r + xpos*r, 1 - 2.5*s  - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( 2.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( 2.5*s+r + xpos*r, 1 - 2.5*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( 2.5*s+r + xpos*r, 1 - 2.5*s - ypos*r-2*s);

				model.bodyFrontOverlay.children[i].material = material;
			}
			//upload bodyLeftOverlay
			for(var i=0; i<48;i++){
				var mygeometry = model.bodyLeftOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);
				uvs[ 0 ][ 0 ].set( 3.5*s + xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( 3.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 0 ][ 2 ].set( 3.5*s+r + xpos*r, 1 - 2.5*s  - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( 3.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( 3.5*s+r + xpos*r, 1 - 2.5*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( 3.5*s+r + xpos*r, 1 - 2.5*s - ypos*r-2*s);

				model.bodyLeftOverlay.children[i].material = material;
			}
			//upload bodyBackOverlay
			for(var i=0; i<96;i++){
				var mygeometry = model.bodyBackOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%8;
				var ypos = Math.floor(i/8);
				uvs[ 0 ][ 0 ].set( 4*s + xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( 4*s + xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 0 ][ 2 ].set( 4*s+r + xpos*r, 1 - 2.5*s  - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( 4*s + xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( 4*s+r + xpos*r, 1 - 2.5*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( 4*s+r + xpos*r, 1 - 2.5*s - ypos*r-2*s);

				model.bodyBackOverlay.children[i].material = material;
			}


			//upload rightLegTop
			for(var i=0; i<model.rightLegTop.children.length;i++){
				var mygeometry = model.rightLegTop.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 0.5*s + xpos*r, 1 - 2*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 0.5*s + xpos*r, 1 - 2*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 0.5*s+r + xpos*r, 1 - 2*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 0.5*s + xpos*r, 1 - 2*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 0.5*s+r + xpos*r, 1 - 2*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 0.5*s+r + xpos*r, 1 - 2*s - ypos*r);

				model.rightLegTop.children[i].material = material;
			}
			//upload rightLegBot
			for(var i=0; i<model.rightLegBot.children.length;i++){
				var mygeometry = model.rightLegBot.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 1*s + xpos*r, 1 - 2*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 1*s + xpos*r, 1 - 2*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 1*s + r + xpos*r, 1 - 2*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 1*s + xpos*r, 1 - 2*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 1*s + r + xpos*r, 1 - 2*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 1*s + r + xpos*r, 1 - 2*s - ypos*r);

				model.rightLegBot.children[i].material = material;
			}
			//upload rightLegRight
			for(var i=0; i<model.rightLegRight.children.length;i++){
				var mygeometry = model.rightLegRight.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( xpos*r, 1 - 2.5*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( r + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( r + xpos*r, 1 - 2.5*s - ypos*r);

				model.rightLegRight.children[i].material = material;
			}
			//upload rightLegFront
			for(var i=0; i<model.rightLegFront.children.length;i++){
				var mygeometry = model.rightLegFront.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 0.5*s + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 0.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 0.5*s+r + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 0.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 0.5*s+r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 0.5*s+r + xpos*r, 1 - 2.5*s - ypos*r);

				model.rightLegFront.children[i].material = material;
			}
			//upload rightLegLeft
			for(var i=0; i<model.rightLegLeft.children.length;i++){
				var mygeometry = model.rightLegLeft.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( s + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( s + xpos*r, 1 - 2.5*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( s + r + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( s + r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( s + r + xpos*r, 1 - 2.5*s - ypos*r);

				model.rightLegLeft.children[i].material = material;
			}
			//upload rightLegBack
			for(var i=0; i<model.rightLegBack.children.length;i++){
				var mygeometry = model.rightLegBack.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 1.5*s + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 1.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 1.5*s + r + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 1.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 1.5*s + r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 1.5*s + r + xpos*r, 1 - 2.5*s - ypos*r);

				model.rightLegBack.children[i].material = material;
			}
			
			//upload rightLegTopOverlay
			for(var i=0; i<model.rightLegTopOverlay.children.length;i++){
				var mygeometry = model.rightLegTopOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 0.5*s + xpos*r, 1 - 2*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( 0.5*s + xpos*r, 1 - 2*s - r  - ypos*r -2*s);
				uvs[ 0 ][ 2 ].set( 0.5*s+r + xpos*r, 1 - 2*s - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( 0.5*s + xpos*r, 1 - 2*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( 0.5*s+r + xpos*r, 1 - 2*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( 0.5*s+r + xpos*r, 1 - 2*s - ypos*r-2*s);

				model.rightLegTopOverlay.children[i].material = material;
			}
			//upload rightLegBotOverlay
			for(var i=0; i<model.rightLegBotOverlay.children.length;i++){
				var mygeometry = model.rightLegBotOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 1*s + xpos*r, 1 - 2*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( 1*s + xpos*r, 1 - 2*s - r  - ypos*r -2*s);
				uvs[ 0 ][ 2 ].set( 1*s + r + xpos*r, 1 - 2*s - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( 1*s + xpos*r, 1 - 2*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( 1*s + r + xpos*r, 1 - 2*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( 1*s + r + xpos*r, 1 - 2*s - ypos*r-2*s);

				model.rightLegBotOverlay.children[i].material = material;
			}
			//upload rightLegRightOverlay
			for(var i=0; i<model.rightLegRightOverlay.children.length;i++){
				var mygeometry = model.rightLegRightOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( xpos*r, 1 - 2.5*s - r  - ypos*r -2*s);
				uvs[ 0 ][ 2 ].set( r + xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( r + xpos*r, 1 - 2.5*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( r + xpos*r, 1 - 2.5*s - ypos*r-2*s);

				model.rightLegRightOverlay.children[i].material = material;
			}
			//upload rightLegFrontOverlay
			for(var i=0; i<model.rightLegFrontOverlay.children.length;i++){
				var mygeometry = model.rightLegFrontOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 0.5*s + xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( 0.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r -2*s);
				uvs[ 0 ][ 2 ].set( 0.5*s+r + xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( 0.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( 0.5*s+r + xpos*r, 1 - 2.5*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( 0.5*s+r + xpos*r, 1 - 2.5*s - ypos*r-2*s);

				model.rightLegFrontOverlay.children[i].material = material;
			}
			//upload rightLegLeftOverlay
			for(var i=0; i<model.rightLegLeftOverlay.children.length;i++){
				var mygeometry = model.rightLegLeftOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( s + xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( s + xpos*r, 1 - 2.5*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( s + r + xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( s + xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( s + r + xpos*r, 1 - 2.5*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( s + r + xpos*r, 1 - 2.5*s - ypos*r-2*s);

				model.rightLegLeftOverlay.children[i].material = material;
			}
			//upload rightLegBackOverlay
			for(var i=0; i<model.rightLegBackOverlay.children.length;i++){
				var mygeometry = model.rightLegBackOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 1.5*s + xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 0 ][ 1 ].set( 1.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r -2*s);
				uvs[ 0 ][ 2 ].set( 1.5*s + r + xpos*r, 1 - 2.5*s - ypos*r-2*s);
				uvs[ 1 ][ 0 ].set( 1.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r-2*s);
				uvs[ 1 ][ 1 ].set( 1.5*s + r + xpos*r, 1 - 2.5*s - r - ypos*r-2*s);
				uvs[ 1 ][ 2 ].set( 1.5*s + r + xpos*r, 1 - 2.5*s - ypos*r-2*s);

				model.rightLegBackOverlay.children[i].material = material;
			}
			
			//upload rightArmTop
			for(var i=0; i<model.rightArmTop.children.length;i++){
				var mygeometry = model.rightArmTop.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set(5.5*s + xpos*r, 1 - 2*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5.5*s + xpos*r, 1 - 2*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5.5*s+r + xpos*r, 1 - 2*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5.5*s + xpos*r, 1 - 2*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 5.5*s+r + xpos*r, 1 - 2*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5.5*s+r + xpos*r, 1 - 2*s - ypos*r);

				model.rightArmTop.children[i].material = material;
			}
			//upload rightArmBot
			for(var i=0; i<model.rightArmBot.children.length;i++){
				var mygeometry = model.rightArmBot.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%3;
				var ypos = Math.floor(i/3);

				uvs[ 0 ][ 0 ].set(5.5*s+4*r + xpos*r, 1 - 2*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5.5*s+4*r + xpos*r, 1 - 2*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5.5*s+r+4*r + xpos*r, 1 - 2*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5.5*s+4*r + xpos*r, 1 - 2*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 5.5*s+4*r+r + xpos*r, 1 - 2*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5.5*s+4*r+r + xpos*r, 1 - 2*s - ypos*r);

				model.rightArmBot.children[i].material = material;
			}
			//upload rightArmRight
			for(var i=0; i<model.rightArmRight.children.length;i++){
				var mygeometry = model.rightArmRight.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5*s + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5*s + xpos*r, 1 - 2.5*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5*s+r + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 5*s+r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5*s+r + xpos*r, 1 - 2.5*s - ypos*r);

				model.rightArmRight.children[i].material = material;
			}
			//upload rightArmFront
			for(var i=0; i<model.rightArmFront.children.length;i++){
				var mygeometry = model.rightArmFront.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%3;
				var ypos = Math.floor(i/3);

				uvs[ 0 ][ 0 ].set( 5.5*s + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5.5*s+r + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 5.5*s+r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5.5*s+r + xpos*r, 1 - 2.5*s - ypos*r);

				model.rightArmFront.children[i].material = material;
			}
			//upload rightArmLeft
			for(var i=0; i<model.rightArmLeft.children.length;i++){
				var mygeometry = model.rightArmLeft.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5.5*s+4*r + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5.5*s+4*r + xpos*r, 1 - 2.5*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5.5*s+4*r+r + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5.5*s+4*r + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 5.5*s+4*r+r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5.5*s+4*r+r + xpos*r, 1 - 2.5*s - ypos*r);

				model.rightArmLeft.children[i].material = material;
			}
			//upload rightArmBack
			for(var i=0; i<model.rightArmBack.children.length;i++){
				var mygeometry = model.rightArmBack.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%3;
				var ypos = Math.floor(i/3);

				uvs[ 0 ][ 0 ].set( 5.5*s+8*r + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5.5*s+8*r + xpos*r, 1 - 2.5*s - r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5.5*s+8*r+r + xpos*r, 1 - 2.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5.5*s+8*r + xpos*r, 1 - 2.5*s - r  - ypos*r);
				uvs[ 1 ][ 1 ].set( 5.5*s+8*r+r + xpos*r, 1 - 2.5*s - r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5.5*s+8*r+r + xpos*r, 1 - 2.5*s - ypos*r);

				model.rightArmBack.children[i].material = material;
			}
			//upload rightArmTopOverlay
			for(var i=0; i<model.rightArmTopOverlay.children.length;i++){
				var mygeometry = model.rightArmTopOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set(5.5*s + xpos*r, 1 - 2*s - ypos*r -2*s);
				uvs[ 0 ][ 1 ].set( 5.5*s + xpos*r, 1 - 2*s - r  - ypos*r -2*s );
				uvs[ 0 ][ 2 ].set( 5.5*s+r + xpos*r, 1 - 2*s - ypos*r -2*s);
				uvs[ 1 ][ 0 ].set( 5.5*s + xpos*r, 1 - 2*s - r  - ypos*r -2*s);
				uvs[ 1 ][ 1 ].set( 5.5*s+r + xpos*r, 1 - 2*s - r - ypos*r -2*s);
				uvs[ 1 ][ 2 ].set( 5.5*s+r + xpos*r, 1 - 2*s - ypos*r -2*s);

				model.rightArmTopOverlay.children[i].material = material;
			}
			//upload rightArmBotOverlay
			for(var i=0; i<model.rightArmBotOverlay.children.length;i++){
				var mygeometry = model.rightArmBotOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set(5.5*s+4*r + xpos*r, 1 - 2*s - ypos*r -2*s);
				uvs[ 0 ][ 1 ].set( 5.5*s+4*r + xpos*r, 1 - 2*s - r  - ypos*r -2*s );
				uvs[ 0 ][ 2 ].set( 5.5*s+r+4*r + xpos*r, 1 - 2*s - ypos*r -2*s);
				uvs[ 1 ][ 0 ].set( 5.5*s+4*r + xpos*r, 1 - 2*s - r  - ypos*r -2*s);
				uvs[ 1 ][ 1 ].set( 5.5*s+4*r+r + xpos*r, 1 - 2*s - r - ypos*r -2*s);
				uvs[ 1 ][ 2 ].set( 5.5*s+4*r+r + xpos*r, 1 - 2*s - ypos*r -2*s);

				model.rightArmBotOverlay.children[i].material = material;
			}
			//upload rightArmRightOverlay
			for(var i=0; i<model.rightArmRightOverlay.children.length;i++){
				var mygeometry = model.rightArmRightOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5*s + xpos*r, 1 - 2.5*s - ypos*r -2*s);
				uvs[ 0 ][ 1 ].set( 5*s + xpos*r, 1 - 2.5*s - r  - ypos*r -2*s );
				uvs[ 0 ][ 2 ].set( 5*s+r + xpos*r, 1 - 2.5*s - ypos*r -2*s);
				uvs[ 1 ][ 0 ].set( 5*s + xpos*r, 1 - 2.5*s - r  - ypos*r -2*s);
				uvs[ 1 ][ 1 ].set( 5*s+r + xpos*r, 1 - 2.5*s - r - ypos*r -2*s);
				uvs[ 1 ][ 2 ].set( 5*s+r + xpos*r, 1 - 2.5*s - ypos*r -2*s);

				model.rightArmRightOverlay.children[i].material = material;
			}
			//upload rightArmFrontOverlay
			for(var i=0; i<model.rightArmFrontOverlay.children.length;i++){
				var mygeometry = model.rightArmFrontOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5.5*s + xpos*r, 1 - 2.5*s - ypos*r -2*s);
				uvs[ 0 ][ 1 ].set( 5.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r -2*s );
				uvs[ 0 ][ 2 ].set( 5.5*s+r + xpos*r, 1 - 2.5*s - ypos*r -2*s);
				uvs[ 1 ][ 0 ].set( 5.5*s + xpos*r, 1 - 2.5*s - r  - ypos*r -2*s);
				uvs[ 1 ][ 1 ].set( 5.5*s+r + xpos*r, 1 - 2.5*s - r - ypos*r -2*s);
				uvs[ 1 ][ 2 ].set( 5.5*s+r + xpos*r, 1 - 2.5*s - ypos*r -2*s);

				model.rightArmFrontOverlay.children[i].material = material;
			}
			//upload rightArmLeftOverlay
			for(var i=0; i<model.rightArmLeftOverlay.children.length;i++){
				var mygeometry = model.rightArmLeftOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5.5*s+4*r + xpos*r, 1 - 2.5*s - ypos*r -2*s);
				uvs[ 0 ][ 1 ].set( 5.5*s+4*r + xpos*r, 1 - 2.5*s - r  - ypos*r -2*s );
				uvs[ 0 ][ 2 ].set( 5.5*s+4*r+r + xpos*r, 1 - 2.5*s - ypos*r -2*s);
				uvs[ 1 ][ 0 ].set( 5.5*s+4*r + xpos*r, 1 - 2.5*s - r  - ypos*r -2*s);
				uvs[ 1 ][ 1 ].set( 5.5*s+4*r+r + xpos*r, 1 - 2.5*s - r - ypos*r -2*s);
				uvs[ 1 ][ 2 ].set( 5.5*s+4*r+r + xpos*r, 1 - 2.5*s - ypos*r -2*s);

				model.rightArmLeftOverlay.children[i].material = material;
			}
			//upload rightArmBackOverlay
			for(var i=0; i<model.rightArmBackOverlay.children.length;i++){
				var mygeometry = model.rightArmBackOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5.5*s+8*r + xpos*r, 1 - 2.5*s - ypos*r -2*s);
				uvs[ 0 ][ 1 ].set( 5.5*s+8*r + xpos*r, 1 - 2.5*s - r  - ypos*r -2*s );
				uvs[ 0 ][ 2 ].set( 5.5*s+8*r+r + xpos*r, 1 - 2.5*s - ypos*r -2*s);
				uvs[ 1 ][ 0 ].set( 5.5*s+8*r + xpos*r, 1 - 2.5*s - r  - ypos*r -2*s);
				uvs[ 1 ][ 1 ].set( 5.5*s+8*r+r + xpos*r, 1 - 2.5*s - r - ypos*r -2*s);
				uvs[ 1 ][ 2 ].set( 5.5*s+8*r+r + xpos*r, 1 - 2.5*s - ypos*r -2*s);

				model.rightArmBackOverlay.children[i].material = material;
			}
			//upload leftLegTop			
			for(var i=0; i<model.leftLegTop.children.length;i++){
				var mygeometry = model.leftLegTop.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 2.5*s + xpos*r, 1 -6*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 2.5*s + xpos*r, 1 -6*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 2.5*s+r + xpos*r, 1  -6*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 2.5*s + xpos*r, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 2.5*s+r + xpos*r, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 2.5*s+r + xpos*r, 1 -6*s - ypos*r);

				model.leftLegTop.children[i].material = material;
			}
			//upload leftLegBot
			for(var i=0; i<model.leftLegBot.children.length;i++){
				var mygeometry = model.leftLegBot.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 3*s + xpos*r, 1 -6*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 3*s + xpos*r, 1 -6*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 3*s+r + xpos*r, 1  -6*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 3*s + xpos*r, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 3*s+r + xpos*r, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 3*s+r + xpos*r, 1 -6*s - ypos*r);

				model.leftLegBot.children[i].material = material;
			}
			//upload leftLegRight
			for(var i=0; i<model.leftLegRight.children.length;i++){
				var mygeometry = model.leftLegRight.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 2*s + xpos*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 2*s + xpos*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 2*s+r + xpos*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 2*s + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 2*s+r + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 2*s+r + xpos*r, 1 -6.5*s - ypos*r);

				model.leftLegRight.children[i].material = material;
			}
			//upload leftLegFront
			for(var i=0; i<model.leftLegFront.children.length;i++){
				var mygeometry = model.leftLegFront.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 2.5*s + xpos*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 2.5*s + xpos*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 2.5*s+r + xpos*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 2.5*s + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 2.5*s+r + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 2.5*s+r + xpos*r, 1 -6.5*s - ypos*r);

				model.leftLegFront.children[i].material = material;
			}
			//upload leftLegLeft
			for(var i=0; i<model.leftLegLeft.children.length;i++){
				var mygeometry = model.leftLegLeft.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 3*s + xpos*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 3*s + xpos*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 3*s+r + xpos*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 3*s + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 3*s+r + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 3*s+r + xpos*r, 1 -6.5*s - ypos*r);

				model.leftLegLeft.children[i].material = material;
			}
			//upload leftLegBack
			for(var i=0; i<model.leftLegBack.children.length;i++){
				var mygeometry = model.leftLegBack.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 3.5*s + xpos*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 3.5*s + xpos*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 3.5*s+r + xpos*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 3.5*s + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 3.5*s+r + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 3.5*s+r + xpos*r, 1 -6.5*s - ypos*r);

				model.leftLegBack.children[i].material = material;
			}
			//upload leftLegTopOverlay
			for(var i=0; i<model.leftLegTopOverlay.children.length;i++){
				var mygeometry = model.leftLegTopOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 2.5*s + xpos*r-2*s, 1 -6*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 2.5*s + xpos*r-2*s, 1 -6*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 2.5*s+r + xpos*r-2*s, 1  -6*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 2.5*s + xpos*r-2*s, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 2.5*s+r + xpos*r-2*s, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 2.5*s+r + xpos*r-2*s, 1 -6*s - ypos*r);

				model.leftLegTopOverlay.children[i].material = material;
			}
			//upload leftLegBotOverlay
			for(var i=0; i<model.leftLegBotOverlay.children.length;i++){
				var mygeometry = model.leftLegBotOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 3*s + xpos*r-2*s, 1 -6*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 3*s + xpos*r-2*s, 1 -6*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 3*s+r + xpos*r-2*s, 1  -6*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 3*s + xpos*r-2*s, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 3*s+r + xpos*r-2*s, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 3*s+r + xpos*r-2*s, 1 -6*s - ypos*r);

				model.leftLegBotOverlay.children[i].material = material;
			}
			//upload leftLegRightOverlay
			for(var i=0; i<model.leftLegRightOverlay.children.length;i++){
				var mygeometry = model.leftLegRightOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 2*s + xpos*r-2*s, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 2*s + xpos*r-2*s, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 2*s+r + xpos*r-2*s, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 2*s + xpos*r-2*s, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 2*s+r + xpos*r-2*s, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 2*s+r + xpos*r-2*s, 1 -6.5*s - ypos*r);

				model.leftLegRightOverlay.children[i].material = material;
			}
			//upload leftLegFrontOverlay
			for(var i=0; i<model.leftLegFrontOverlay.children.length;i++){
				var mygeometry = model.leftLegFrontOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 2.5*s + xpos*r-2*s, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 2.5*s + xpos*r-2*s, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 2.5*s+r + xpos*r-2*s, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 2.5*s + xpos*r-2*s, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 2.5*s+r + xpos*r-2*s, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 2.5*s+r + xpos*r-2*s, 1 -6.5*s - ypos*r);

				model.leftLegFrontOverlay.children[i].material = material;
			}
			//upload leftLegLeftOverlay
			for(var i=0; i<model.leftLegLeftOverlay.children.length;i++){
				var mygeometry = model.leftLegLeftOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 3*s + xpos*r-2*s, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 3*s + xpos*r-2*s, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 3*s+r + xpos*r-2*s, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 3*s + xpos*r-2*s, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 3*s+r + xpos*r-2*s, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 3*s+r + xpos*r-2*s, 1 -6.5*s - ypos*r);

				model.leftLegLeftOverlay.children[i].material = material;
			}
			//upload leftLegBackOverlay
			for(var i=0; i<model.leftLegBackOverlay.children.length;i++){
				var mygeometry = model.leftLegBackOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 3.5*s + xpos*r-2*s, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 3.5*s + xpos*r-2*s, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 3.5*s+r + xpos*r-2*s, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 3.5*s + xpos*r-2*s, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 3.5*s+r + xpos*r-2*s, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 3.5*s+r + xpos*r-2*s, 1 -6.5*s - ypos*r);

				model.leftLegBackOverlay.children[i].material = material;
			}
			//upload leftArmTop	
			for(var i=0; i<model.leftArmTop.children.length;i++){
				var mygeometry = model.leftArmTop.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 4.5*s + xpos*r, 1 -6*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 4.5*s + xpos*r, 1 -6*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 4.5*s+r + xpos*r, 1  -6*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 4.5*s + xpos*r, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 4.5*s+r + xpos*r, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 4.5*s+r + xpos*r, 1 -6*s - ypos*r);

				model.leftArmTop.children[i].material = material;
			}
			//upload leftArmBot
			for(var i=0; i<model.leftArmBot.children.length;i++){
				var mygeometry = model.leftArmBot.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5*s + xpos*r, 1 -6*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5*s + xpos*r, 1 -6*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5*s+r + xpos*r, 1  -6*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5*s + xpos*r, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 5*s+r + xpos*r, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5*s+r + xpos*r, 1 -6*s - ypos*r);

				model.leftArmBot.children[i].material = material;
			}
			//upload leftArmRight
			for(var i=0; i<model.leftArmRight.children.length;i++){
				var mygeometry = model.leftArmRight.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 4*s + xpos*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 4*s + xpos*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 4*s+r + xpos*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 4*s + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 4*s+r + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 4*s+r + xpos*r, 1 -6.5*s - ypos*r);

				model.leftArmRight.children[i].material = material;
			}
			//upload leftArmFront
			for(var i=0; i<model.leftArmFront.children.length;i++){
				var mygeometry = model.leftArmFront.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 4.5*s + xpos*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 4.5*s + xpos*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 4.5*s+r + xpos*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 4.5*s + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 4.5*s+r + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 4.5*s+r + xpos*r, 1 -6.5*s - ypos*r);

				model.leftArmFront.children[i].material = material;
			}
			//upload leftArmLeft
			for(var i=0; i<model.leftArmLeft.children.length;i++){
				var mygeometry = model.leftArmLeft.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5*s + xpos*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5*s + xpos*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5*s+r + xpos*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5*s + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 5*s+r + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5*s+r + xpos*r, 1 -6.5*s - ypos*r);

				model.leftArmLeft.children[i].material = material;
			}
			//upload leftArmBack
			for(var i=0; i<model.leftArmBack.children.length;i++){
				var mygeometry = model.leftArmBack.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5.5*s + xpos*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5.5*s + xpos*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5.5*s+r + xpos*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5.5*s + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 5.5*s+r + xpos*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5.5*s+r + xpos*r, 1 -6.5*s - ypos*r);

				model.leftArmBack.children[i].material = material;
			}
//upload leftArmTop	Overlay
for(var i=0; i<model.leftArmTopOverlay.children.length;i++){
	var mygeometry = model.leftArmTopOverlay.children[i].geometry;
	var uvs = mygeometry.faceVertexUvs[ 0 ];
	var xpos = i%4;
	var ypos = Math.floor(i/4);

	uvs[ 0 ][ 0 ].set( 4.5*s + xpos*r+2*s-2*r, 1 -6*s - ypos*r);
	uvs[ 0 ][ 1 ].set( 4.5*s + xpos*r+2*s-2*r, 1 -6*s -r  - ypos*r );
	uvs[ 0 ][ 2 ].set( 4.5*s+r + xpos*r+2*s-2*r, 1  -6*s - ypos*r);
	uvs[ 1 ][ 0 ].set( 4.5*s + xpos*r+2*s-2*r, 1 -6*s -r - ypos*r);
	uvs[ 1 ][ 1 ].set( 4.5*s+r + xpos*r+2*s-2*r, 1 -6*s -r - ypos*r);
	uvs[ 1 ][ 2 ].set( 4.5*s+r + xpos*r+2*s-2*r, 1 -6*s - ypos*r);

	model.leftArmTopOverlay.children[i].material = material;
}
			//upload leftArmBotOverlay
			for(var i=0; i<model.leftArmBotOverlay.children.length;i++){
				var mygeometry = model.leftArmBotOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5*s + xpos*r+2*s-2*r, 1 -6*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5*s + xpos*r+2*s-2*r, 1 -6*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5*s+r + xpos*r+2*s-2*r, 1  -6*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5*s + xpos*r+2*s-2*r, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 5*s+r + xpos*r+2*s-2*r, 1 -6*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5*s+r + xpos*r+2*s-2*r, 1 -6*s - ypos*r);

				model.leftArmBotOverlay.children[i].material = material;
			}
			//upload leftArmRightOverlay
			for(var i=0; i<model.leftArmRightOverlay.children.length;i++){
				var mygeometry = model.leftArmRightOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 4*s + xpos*r+2*s-2*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 4*s + xpos*r+2*s-2*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 4*s+r + xpos*r+2*s-2*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 4*s + xpos*r+2*s-2*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 4*s+r + xpos*r+2*s-2*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 4*s+r + xpos*r+2*s-2*r, 1 -6.5*s - ypos*r);

				model.leftArmRightOverlay.children[i].material = material;
			}
			//upload leftArmFrontOverlay
			for(var i=0; i<model.leftArmFrontOverlay.children.length;i++){
				var mygeometry = model.leftArmFrontOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 4.5*s + xpos*r+2*s-2*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 4.5*s + xpos*r+2*s-2*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 4.5*s+r + xpos*r+2*s-2*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 4.5*s + xpos*r+2*s-2*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 4.5*s+r + xpos*r+2*s-2*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 4.5*s+r + xpos*r+2*s-2*r, 1 -6.5*s - ypos*r);

				model.leftArmFrontOverlay.children[i].material = material;
			}
			//upload leftArmLeftOverlay
			for(var i=0; i<model.leftArmLeftOverlay.children.length;i++){
				var mygeometry = model.leftArmLeftOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5*s + xpos*r+2*s-2*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5*s + xpos*r+2*s-2*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5*s+r + xpos*r+2*s-2*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5*s + xpos*r+2*s-2*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 5*s+r + xpos*r+2*s-2*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5*s+r + xpos*r+2*s-2*r, 1 -6.5*s - ypos*r);

				model.leftArmLeftOverlay.children[i].material = material;
			}
			//upload leftArmBackOverlay
			for(var i=0; i<model.leftArmBackOverlay.children.length;i++){
				var mygeometry = model.leftArmBackOverlay.children[i].geometry;
				var uvs = mygeometry.faceVertexUvs[ 0 ];
				var xpos = i%4;
				var ypos = Math.floor(i/4);

				uvs[ 0 ][ 0 ].set( 5.5*s + xpos*r+2*s-2*r, 1 -6.5*s - ypos*r);
				uvs[ 0 ][ 1 ].set( 5.5*s + xpos*r+2*s-2*r, 1 -6.5*s -r  - ypos*r );
				uvs[ 0 ][ 2 ].set( 5.5*s+r + xpos*r+2*s-2*r, 1  -6.5*s - ypos*r);
				uvs[ 1 ][ 0 ].set( 5.5*s + xpos*r+2*s-2*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 1 ].set( 5.5*s+r + xpos*r+2*s-2*r, 1 -6.5*s -r - ypos*r);
				uvs[ 1 ][ 2 ].set( 5.5*s+r + xpos*r+2*s-2*r, 1 -6.5*s - ypos*r);

				model.leftArmBackOverlay.children[i].material = material;
			}

        }// end upload


        function moveRender(){

        	if(moveState == 1){
        		requestAnimationFrame( moveRender );
        		cameraControls.update();	

        		var now = new Date().getTime() / 1000;

        		var angle	= 1/23 * now*Math.PI*2;			
        		model.headBox.rotation.x	= 1.4 * Math.sin(now*1.5)/3;
        		model.headBox.rotation.y	= Math.sin(now)/3;
        		model.rightArmBox.rotation.x = 1.4 * Math.cos(angle + Math.PI);
        		model.leftArmBox.rotation.x	= 1.4 * Math.cos(angle);        				
        		model.rightLegBox.rotation.x	= 1.4 * Math.cos(angle);
        		model.leftLegBox.rotation.x	= 1.4 * Math.cos(angle + Math.PI);
			// camera.position.x = camera.position.x + 5;
			// camera.rotation.x += 0.5;

			var timer = Date.now() * 0.0001; 

			camera.position.x = Math.cos( timer ) * 40;
			camera.position.z = Math.sin( timer ) * 40;
			camera.lookAt( scene.position );
			renderer.render( scene, camera );

			// headBoxDiffX += model.headBox.rotation.x;
			// headBoxDiffY += model.headBox.rotation.y;
			// rightArmBoxDiffX += model.rightArmBox.rotation.x;
			// leftArmBoxDiffX += model.leftArmBox.rotation.x;			
			// rightLegBoxDiffX += model.rightLegBox.rotation.x;
			// leftLegBoxDiffX += model.leftLegBox.rotation.x;

		}
	}
	function move(){
		if(moveState ==0){
			// alert("leftArmBoxX normal ="+ leftArmBoxX);
			moveState =1;
			moveRender();
			model.headBorder.visible = false;
			model.bodyBorder.visible = false;
			model.rightArmBorder.visible = false;
			model.rightLegBorder.visible = false;
			model.leftArmBorder.visible = false;
			model.leftLegBorder.visible = false;
		}
		else {
			model.headBorder.visible = true;
			model.bodyBorder.visible = true;
			model.rightArmBorder.visible = true;
			model.rightLegBorder.visible = true;
			model.leftArmBorder.visible = true;
			model.leftLegBorder.visible = true;
			moveState = 0; window.cancelAnimationFrame(moveRender);
			// model.headBox.rotation.x = -headBoxDiffX;
			// model.headBox.rotation.y = -headBoxDiffY;
			// model.rightArmBox.rotation.x = -rightArmBoxDiffX;
			// model.leftArmBox.rotation.x = -leftArmBoxDiffX;
			// model.rightLegBox.rotation.x = -rightLegBoxDiffX;
			// model.leftLegBox.rotation.x = -leftLegBoxDiffX;			
			// alert("leftArmBoxDiffX on move ="+ leftArmBoxDiffX);		
		}
	}
	function overlaySW(){			
		if(overlayDisplayState == 0 ){
			document.getElementById("overlay-sw").style.backgroundColor  =SCENECOLOR;
			overlayDisplayState =1;
			// alert("overlaySW state =1");
			// console.log(model.headOverlay.mesh);
			// console.log(model.headOverlay);
			// console.log(model.headBox);
			model.headOverlay.translateX(100000);
			model.rightArmOverlay.translateX(100000);
			model.leftArmOverlay.translateX(100000);
			model.rightLegOverlay.translateX(100000);
			model.leftLegOverlay.translateX(100000);
			model.bodyOverlay.translateX(100000);
		}
		else{
			document.getElementById("overlay-sw").style.backgroundColor =SWCOLOR;
			overlayDisplayState =0;			
			model.headOverlay.translateX(-100000);
			model.rightArmOverlay.translateX(-100000);
			model.leftArmOverlay.translateX(-100000);
			model.rightLegOverlay.translateX(-100000);
			model.leftLegOverlay.translateX(-100000);
			model.bodyOverlay.translateX(-100000);
		}
	}
	function bodySW(){

		if(bodyDisplayState == 0 ){
			document.getElementById("body-sw").style.backgroundColor =SCENECOLOR;
			bodyDisplayState =1;
			model.head.translateX(100000);
			model.body.translateX(100000);
			model.rightArm.translateX(100000);
			model.leftArm.translateX(100000);
			model.rightLeg.translateX(100000);
			model.leftLeg.translateX(100000);			
		}
		else{
			document.getElementById("body-sw").style.backgroundColor =SWCOLOR;
			bodyDisplayState =0;
			model.head.translateX(-100000);
			model.body.translateX(-100000);
			model.rightArm.translateX(-100000);
			model.leftArm.translateX(-100000);
			model.rightLeg.translateX(-100000);
			model.leftLeg.translateX(-100000);
		}
	}
</script>
</body>
</html>